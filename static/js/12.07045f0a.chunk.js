(this["webpackJsonpjustlend-front"]=this["webpackJsonpjustlend-front"]||[]).push([[12],{1437:function(e,t,a){},1489:function(e,t,a){},1497:function(e,t,a){"use strict";a.r(t);var n,o,i,r,l=a(8),s=a(14),c=a(17),d=a(16),m=a(0),v=a.n(m),u=a(1),p=a.n(u),_=a(4),g=a(2),b=a.n(g),f=a(63),N=a(12),h=a.n(N),E=a(21),j=a(67),k=a(9),O=a(3),w=a(397),S=a(398),F=a(400),P=a(213),T=(a(399),a(1437),Object(E.b)("lend")(n=Object(E.c)(n=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).hideRedeemFromVotePop=function(){n.props.lend.setData({redeemFromVotePop:!1})},n.withdrawVotes=Object(_.a)(p.a.mark((function e(){var t,a,o,i,r,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.lend,a=t.lockNum,o=t.redeemFromVotePopProposalId,a&&o&&!a.lte(0)){e.next=3;break}return e.abrupt("return");case 3:return i={proposalId:o,contractAddr:k.b.contract.WJSTAddress},r={title:"toast.ex",title2:"deposit.transactionsent",title3:"toast.ex_failed",title4:"deposit.confirm_transaction",obj:{value:i.votes,token:i.proposalId||""}},console.log(i),console.log(r),e.next=9,n.props.system.withdrawVotes(i,r);case 9:(l=e.sent)&&(console.log("withdrawVotes complete:",l),n.props.lend.setData({redeemFromVotePop:!1}));case 11:case"end":return e.stop()}}),e)}))),n}return Object(s.a)(a,[{key:"render",value:function(){var e,t=this,a=this.props.lend,n=a.redeemFromVotePop,o=a.lockNum;return o&&o.gt(0)&&(e=Object(O.j)(Object(O.a)(o).div(k.b.tokenDefaultPrecision),3)),v.a.createElement(P.a,{visible:n,title:b.a.get("v2.vote_detail.redeem_vote_modal_title"),width:400,footer:null,className:"j-modal header-border redeem-vote-pop",onCancel:function(){return t.hideRedeemFromVotePop()},closable:!0,maskClosable:!1,centered:!0,getContainer:function(){return document.querySelector(".j-wrapper")}},v.a.createElement("div",{className:"modal-content-container"},v.a.createElement("div",{className:"content-icon"}),v.a.createElement("div",{className:"content-title"},b.a.getHTML("v2.vote_detail.redeem_vote_modal_content_title",{value:e})),v.a.createElement("div",{className:"content-subtitle"},b.a.get("v2.vote_detail.redeem_vote_modal_content_subtitle"))),v.a.createElement("button",{className:"j-large-btn",onClick:function(){return t.withdrawVotes()}},b.a.get("v2.vote_detail.redeem_vote_modal_btn")))}}]),a}(v.a.Component))||n)||n),V=a(319),D=Object(E.b)("lend")(o=Object(E.c)(o=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).hideVoteForPop=function(){n.setState({isSigning:!1,isRejected:!1,isTransactionSent:!1,voteInputValue:"",inputErrorText:""}),n.props.lend.setData({voteForPop:!1})},n.getVote=function(){console.log("GetVote")},n.maxRender=function(){return v.a.createElement("div",{className:"max-value-button",onClick:n.chooseMax},b.a.get("v2.vote_detail.vote_modal_max_value"))},n.chooseMax=function(){var e=n.props.lend.voteInfo,t=Object(O.j)(e.jstBalance.div(k.b.tokenDefaultPrecision),3,{per:!0});n.setState({voteInputValue:t})},n.voteInputValueOnChange=function(e){var t=Object(O.U)(e,3),a=t.valid,o=t.str;if(a){n.setState({voteInputValue:o});var i=n.props.lend.voteInfo;i&&i.success&&i.jstBalance.div(k.b.tokenDefaultPrecision).lt(Object(O.a)(o))?n.setState({inputErrorText:b.a.get("v2.vote_detail.vote_modal_insufficient_vote")}):n.setState({inputErrorText:""})}},n.vote=Object(_.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isSigning:!0,isRejected:!1}),n.setState({isSigning:!1,isTransactionSent:!0}),e.abrupt("return");case 10:e.sent?(n.setState({isSigning:!1,isTransactionSent:!0}),setTimeout((function(){n.props.lend.getVoteDetail(void 0)}),5e3)):n.setState({isSigning:!1,isRejected:!0}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),n.setState({isSigning:!1,isRejected:!0});case 17:case"end":return e.stop()}}),e,null,[[7,14]])}))),n.state={isSigning:!1,isRejected:!1,isTransactionSent:!1,voteInputValue:"",inputErrorText:""},n}return Object(s.a)(a,[{key:"render",value:function(){var e,t,a,n,o,i=this,r=this.props.lend,l=r.voteForPop,s=r.voteForPopIsFor,c=r.voteForPopProposalId,d=r.lockNum,m=r.voteInfo,u=this.state,p=u.isSigning,_=u.isRejected,g=u.isTransactionSent,f=u.voteInputValue,N=u.inputErrorText,E=!1,j=d&&Object(O.a)(d).gt(0),w="--",S="--";return j&&(w=Object(O.j)(Object(O.a)(d).div(k.b.tokenDefaultPrecision),3)),m&&m.success&&(E=Object(O.a)(m.jstBalance).gt(0),S=Object(O.j)(m.jstBalance.div(k.b.tokenDefaultPrecision),3,{miniText:.001})),E=!0,j=!0,w="76.123",S="0.123",g?(e=b.a.get("v2.vote_detail.vote_modal_title_transaction_sent"),t=b.a.get("v2.vote_detail.vote_modal_content_title_wait_for_confirm"),a="",n=b.a.get("v2.vote_detail.vote_modal_btn_ok"),o=!1):E?(e=b.a.get("v2.vote_detail.vote_modal_title",{value:c}),o=!0,j?(t=v.a.createElement("span",{className:"vote-title"},w),a=s?b.a.get("v2.vote_detail.vote_modal_content_title_voted_for",{value:c}):b.a.get("v2.vote_detail.vote_modal_content_title_voted_against",{value:c})):(t=s?b.a.getHTML("v2.vote_detail.vote_modal_content_title_will_vote_for",{value:c}):b.a.getHTML("v2.vote_detail.vote_modal_content_title_will_vote_against",{value:c}),a=""),n=p?b.a.get("v2.vote_detail.vote_modal_btn_wallet_confirm"):s?b.a.get("v2.vote_detail.vote_modal_btn_for"):b.a.get("v2.vote_detail.vote_modal_btn_against")):(e=b.a.get("v2.vote_detail.vote_modal_content_title_no_vote"),t=b.a.get("v2.vote_detail.vote_modal_content_title_no_vote"),a="",n=b.a.get("v2.vote_detail.vote_modal_btn_no_vote"),o=!1),v.a.createElement(P.a,{visible:l,title:e,width:400,footer:null,className:"j-modal header-border vote-pop",onCancel:function(){return i.hideVoteForPop()},closable:!0,maskClosable:!1,centered:!0,getContainer:function(){return document.querySelector(".j-wrapper")}},v.a.createElement("div",{className:h()("modal-content-container",{"have-input":E&&!g})},v.a.createElement("div",{className:h()("content-icon",{"no-vote":!E},{"transaction-sent":g})}),v.a.createElement("div",{className:"content-title"},t),a&&v.a.createElement("div",{className:"content-subtitle"},a),o&&v.a.createElement("div",{className:"input-container"},v.a.createElement("div",{className:"input-header"},v.a.createElement("div",{className:"input-title"},j?b.a.getHTML("v2.vote_detail.vote_modal_add_vote_count"):b.a.getHTML("v2.vote_detail.vote_modal_vote_count")),v.a.createElement("div",{className:"remaining-votes"},v.a.createElement("div",{className:"text"},b.a.get("v2.vote_detail.vote_modal_remaining_vote")),v.a.createElement("div",{className:"balance"},S))),v.a.createElement(V.a,{className:"j-input "+(N?"j-error-input":""),value:f,placeholder:b.a.get("v2.vote_detail.vote_modal_input_hint"),addonAfter:this.maxRender(),onChange:function(e){return i.voteInputValueOnChange(e.target.value)},allowClear:!0,disabled:!!p}),v.a.createElement("div",{className:h()("j-error-tip",{"show-error":N})},v.a.createElement("span",{className:"j-error-img"}),v.a.createElement("div",null,N)))),v.a.createElement("button",{className:h()("j-large-btn",{"is-signing":E&&!g&&p}),disabled:E&&!g&&(p||N||!f||"0"==f),onClick:function(){E?g?i.hideVoteForPop():i.vote():i.getVote()}},n,v.a.createElement("span",{className:"siging-icon"})),_&&v.a.createElement("div",{className:"j-error-tip wallet-reject"},v.a.createElement("span",{className:"j-error-img"}),v.a.createElement("div",null,b.a.get("v2.vote_detail.vote_modal_wallet_rejected"))))}}]),a}(v.a.Component))||o)||o,I=(a(1489),"succeeded"),x="failed",C="pending",y="waiting",R=Object(E.b)("network")(i=Object(E.b)("system")(i=Object(E.b)("lend")(i=Object(E.c)(i=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).componentDidMount=Object(_.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.title="Vote - JustLend DAO",n.props.lend.setData({voteDetailData:null}),n.getProposalIdFromUrl();case 3:case"end":return e.stop()}}),e)}))),n.getProposalIdFromUrl=function(){n.props.lend.setData({lockNum:Object(O.a)(0)});var e=Object(O.F)("proposalId");n.setState({proposalId:e},(function(){n.props.lend.getVoteDetail(e)}))},n.getFormattedTimeString=function(e){return new Date(e).format("yyyy-MM-dd h:m:s")},n.showRedeemFromVotePop=function(){var e=n.state.proposalId;n.props.lend.setData({redeemFromVotePop:!0,redeemFromVotePopProposalId:e}),n.props.lend.setData({lockNum:Object(O.a)(601e18)})},n.voteAgainstButtonOnClick=function(){var e=n.state.proposalId;"yes"!==n.props.lend.addVote&&n.props.lend.setData({voteForPop:!0,voteForPopIsFor:!1,voteForPopProposalId:e})},n.voteForButtonOnClick=function(){var e=n.state.proposalId;"no"!==n.props.lend.addVote&&n.props.lend.setData({voteForPop:!0,voteForPopIsFor:!0,voteForPopProposalId:e})},n.state={mobile:Object(f.a)(window.navigator).any,lang:window.localStorage.getItem("lang")||b.a.options.currentLocale,proposalId:void 0},n}return Object(s.a)(a,[{key:"render",value:function(){var e,t,a,n,o,i,r,l,s,c,d,m,u,p,_=this,g=this.state,f=g.lang,N=(g.mobile,this.props.lend),E=N.theme,P=N.voteDetailData,V=N.addVote,R=N.lockNum,M=this.props.network.isConnected,B="en-US"===f,L=[];if(P){console.log("voteDetailData: ",JSON.stringify(P)),e=B?P.title.split("&&")[1]:P.title.split("&&")[0],t=P.proposalId,a=B?P.content.split("&&&&&&&&")[0]:P.content.split("&&&&&&&&")[1];var q=P.state;L.push({statusNumber:0,icon:I,title:b.a.get("v2.vote_detail.status_created"),timeString:this.getFormattedTimeString(P.activeTime)}),2!=q&&L.push({statusNumber:1,icon:1==q||-1==q?C:I,title:b.a.get("v2.vote_detail.status_voting"),timeString:this.getFormattedTimeString(P.activeTime)}),2==q&&L.push({statusNumber:2,icon:x,title:b.a.get("v2.vote_detail.status_cancel_creation"),timeString:this.getFormattedTimeString(P.cancelTime)}),3==q&&L.push({statusNumber:3,icon:x,title:b.a.get("v2.vote_detail.status_failed"),timeString:this.getFormattedTimeString(P.endTime)}),q>3&&L.push({statusNumber:3,icon:I,title:b.a.get("v2.vote_detail.status_passed"),timeString:this.getFormattedTimeString(P.endTime)}),5==q&&L.push({statusNumber:5,icon:C,title:b.a.get("v2.vote_detail.status_wait_for_queue"),timeString:this.getFormattedTimeString(P.queuedTime)}),q>5&&L.push({statusNumber:5,icon:I,title:b.a.get("v2.vote_detail.status_queuing"),timeString:this.getFormattedTimeString(P.queuedTime)}),6==q&&L.push({statusNumber:6,icon:x,title:b.a.get("v2.vote_detail.status_expired"),timeString:this.getFormattedTimeString(P.queuedTime+2592e5)}),7==q&&L.push({statusNumber:7,icon:I,title:b.a.get("v2.vote_detail.status_executed"),timeString:this.getFormattedTimeString(P.executedTime)}),n=!0;var H=Object(O.a)(P.forVotes),A=Object(O.a)(P.againstVotes);if(o=H.gt(0),i=A.gt(0),r=Object(O.j)(H.div(k.b.tokenDefaultPrecision)._toHex(),3),l=Object(O.j)(A.div(k.b.tokenDefaultPrecision)._toHex(),3),H<=0&&A<=0)s=-1;else if(H<=0)s=0;else if(A<=0)s=100;else{var U=H/A;s=Object(O.a)(U/(1+U)*100).integerValue(O.a.ROUND_HALF_UP)}var J=Object(O.a)(R).gt(0);c=M&&(0==q||1==q),m="no"==V&&J,d="yes"==V&&J,u=Object(O.j)(Object(O.a)(R).div(k.b.tokenDefaultPrecision),3),p=M&&"1"!=P.state&&"0"!=P.state&&J,c=!0,u="76.123",p=!0}return v.a.createElement("div",{className:"j-wrapper "+E},v.a.createElement(S.a,null),v.a.createElement("div",{className:"j-container"},P?v.a.createElement("div",{className:"vote-detail"},v.a.createElement(j.b,{className:"back-to-vote-button",to:"/vote"},b.a.get("v2.vote_detail.back_to_vote_btn")),v.a.createElement("div",{className:"vote-detail-header"},v.a.createElement("div",{className:"vote-detail-title-container"},v.a.createElement("div",{className:"vote-detail-title"},e,v.a.createElement("span",{className:"proposal-id-tag"},"#"+t)),v.a.createElement("div",{className:"vote-detail-links-row"},v.a.createElement("a",{className:"link-item",href:k.b.tronscanUrl,target:"_blank"},b.a.get("v2.vote_detail.header_chain_info_link")),v.a.createElement("a",{className:"link-item",href:k.b.github,target:"_blank"},b.a.get("v2.vote_detail.header_github_link")),v.a.createElement("a",{className:"link-item",href:k.b.forum,target:"_blank"},b.a.get("v2.vote_detail.header_forum_link")))),v.a.createElement("div",{className:"vote-detail-status-box content-container"},L.map((function(e){return v.a.createElement("div",{className:"status-history",key:"history"+e.statusNumber},v.a.createElement("div",{className:h()("timeline-icon",{succeeded:e.icon===I},{failed:e.icon===x},{pending:e.icon===C},{waiting:e.icon===y})}),v.a.createElement("div",{className:"status-title"},e.title),v.a.createElement("div",{className:"status-time"},e.timeString))})))),n&&v.a.createElement("div",{className:"progress-bar-container"},v.a.createElement("div",{className:h()("support-progress-bar-container",{"zero-vote":!o}),style:{flexBasis:s+"%"}},v.a.createElement("div",{className:"progress-bar-title"},b.a.get("v2.vote_detail.support_progress_title")),v.a.createElement("div",{className:"progress-bar-vote-string"},r),d&&v.a.createElement("div",{className:"wallet-vote-container"},v.a.createElement("div",{className:"vote-icon"}),v.a.createElement("div",{className:"wallet-vote-count"},u)),c&&v.a.createElement("button",{className:"action-button",disabled:m,onClick:function(){return _.voteForButtonOnClick()}},b.a.get(d?"v2.vote_detail.add_vote_btn":"v2.vote_detail.support_btn")),v.a.createElement("div",{className:"progress-bar-background"},v.a.createElement("div",{className:"progress-bar"})),v.a.createElement("div",{className:"progress-bar"}),v.a.createElement("div",{className:"progress-bar square-upper-half"})),v.a.createElement("div",{className:h()("against-progress-bar-container",{"zero-vote":!i}),style:{flexBasis:100-s+"%"}},v.a.createElement("div",{className:"progress-bar-title"},b.a.get("v2.vote_detail.against_progress_title")),v.a.createElement("div",{className:"progress-bar-vote-string"},l),m&&v.a.createElement("div",{className:"wallet-vote-container"},v.a.createElement("div",{className:"vote-icon"}),v.a.createElement("div",{className:"wallet-vote-count"},u)),c&&v.a.createElement("button",{className:"action-button",disabled:d,onClick:function(){return _.voteAgainstButtonOnClick()}},b.a.get(m?"v2.vote_detail.add_vote_btn":"v2.vote_detail.against_btn")),v.a.createElement("div",{className:"progress-bar-background"},v.a.createElement("div",{className:"progress-bar"})),v.a.createElement("div",{className:"progress-bar"}),v.a.createElement("div",{className:"progress-bar square-upper-half"}))),!M&&v.a.createElement("div",{className:"connect-wallet-hint-bar content-container content-container-shadow"},v.a.createElement("div",{className:"bar-title"},b.a.get("v2.vote_detail.connect_wallet_title")),v.a.createElement("button",{className:"bar-action-btn",onClick:function(){return _.props.network.connectWalletV2()}},b.a.get("v2.vote_detail.connect_wallet_btn"))),p&&v.a.createElement("div",{className:"redeem-vote-bar content-container content-container-shadow"},v.a.createElement("div",{className:"bar-title"},b.a.get("v2.vote_detail.redeem_vote_title",{value:u})),v.a.createElement("button",{className:"bar-action-btn",onClick:function(){return _.showRedeemFromVotePop()}},b.a.get("v2.vote_detail.redeem_vote_btn"))),v.a.createElement("div",{className:"vote-detail-info-container content-container content-container-shadow"},v.a.createElement("div",{className:"vote-detail-info-header"},b.a.get("v2.vote_detail.info_title")),v.a.createElement("div",{className:"vote-detail-info-text",dangerouslySetInnerHTML:{__html:a}}))):v.a.createElement("div",{className:"loading-screen"},"Loading")),P&&v.a.createElement(w.a,null),v.a.createElement(T,null),v.a.createElement(D,null),v.a.createElement(F.a,null))}}]),a}(v.a.Component))||i)||i)||i)||i,M=Object(E.b)("network")(r=Object(E.c)(r=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.props.network.setData({routeName:"vote"})}},{key:"render",value:function(){return v.a.createElement("div",null,v.a.createElement(R,null))}}]),a}(v.a.Component))||r)||r;t.default=M}}]);