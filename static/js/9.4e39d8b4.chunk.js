(this["webpackJsonpjustlend-front"]=this["webpackJsonpjustlend-front"]||[]).push([[9],{1415:function(e,t,a){"use strict";var n,s=a(8),r=a(14),o=a(17),l=a(16),c=a(0),i=a.n(c),d=(a(63),a(21)),m=a(3),u=a(213),p=a(2),v=a.n(p),f=(a(695),a(395)),b=a.n(f),h=a(396),g=a.n(h),w=(a(1416),a(155)),E=a.n(w),N=a(154),j=a.n(N),x=Object(d.b)("network")(n=Object(d.b)("lend")(n=Object(d.b)("system")(n=Object(d.c)(n=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(s.a)(this,a),(e=t.call(this)).close=function(){e.props.system.setData({transModalInfo:{visible:!1}})},e.state={},e}return Object(r.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props.system.transModalInfo,a=t.visible,n=t.step,s=t.txId,r=t.title,o=t.obj,l=t.title2,c=t.title3,d=t.title4;return i.a.createElement(u.a,{title:"",visible:a,closable:!0,icon:null,onCancel:function(){return e.props.system.hideTransModal()},footer:null,width:345,className:"trans-modal"},i.a.createElement("div",{className:"trans-modal-body center"},1==n?i.a.createElement(i.a.Fragment,{key:"step1"},r&&i.a.createElement("div",{className:"trans-modal-title"},v.a.get(d||r,o)),i.a.createElement("div",{className:"trans-modal-icon"},i.a.createElement("img",{src:j.a,className:"authorizeIcon"}),i.a.createElement("div",{className:"points"},i.a.createElement("span",{className:"point"}),i.a.createElement("span",{className:"point"}),i.a.createElement("span",{className:"point"}))),i.a.createElement("div",{className:"trans-modal-status trans-modal-wait-confirm"},v.a.get("deposit.signTronlink"))):null,2==n?i.a.createElement(i.a.Fragment,{key:"step2"},i.a.createElement("div",{className:"trans-modal-title"},v.a.get(l||"deposit.transactionsent",o)),i.a.createElement("div",{className:"trans-modal-icon"},i.a.createElement("img",{src:g.a,alt:"",style:{width:"40px"}})),i.a.createElement("div",{className:"trans-modal-tips trans-modal-submit-tips"},Object(m.ib)(v.a.get("deposit.explanation4"),s)),i.a.createElement("div",{className:"modal-btn border-btn",onClick:this.props.system.hideTransModal,style:{marginTop:"20px"}},v.a.get("deposit.closed"))):null,3==n?i.a.createElement(i.a.Fragment,{key:"step3"},i.a.createElement("div",{className:"trans-modal-title"},v.a.get(c||"toast.ex_failed",o)),i.a.createElement("div",{className:"trans-modal-icon"},i.a.createElement("img",{src:b.a,alt:"",style:{width:"40px"}})),i.a.createElement("div",{className:"trans-modal-status trans-modal-cancel"},v.a.get("deposit.explanation3"))):null,4==n?i.a.createElement(i.a.Fragment,{key:"step1"},r&&i.a.createElement("div",{className:"trans-modal-title"},v.a.get(d||r,o)),i.a.createElement("div",{className:"trans-modal-icon"},i.a.createElement("img",{src:E.a,className:"authorizeIcon"}),i.a.createElement("div",{className:"points"},i.a.createElement("span",{className:"point"}),i.a.createElement("span",{className:"point"}),i.a.createElement("span",{className:"point"}))),i.a.createElement("div",{className:"trans-modal-status trans-modal-wait-confirm"},v.a.get("deposit.signWalletConnect"))):null))}}]),a}(i.a.Component))||n)||n)||n)||n;t.a=x},1416:function(e,t,a){e.exports=a.p+"static/media/authorize.6f2e8e85.svg"},1425:function(e,t,a){},1426:function(e,t,a){"use strict";var n,s=a(1),r=a.n(s),o=a(4),l=a(8),c=a(14),i=a(17),d=a(16),m=a(0),u=a.n(m),p=(a(63),a(21)),v=a(3),f=a(213),b=a(2),h=a.n(b),g=a(9),w=(a(695),Object(p.b)("network")(n=Object(p.b)("lend")(n=Object(p.b)("system")(n=Object(p.c)(n=function(e){Object(i.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).startInterval=Object(o.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.timerInterval||(e.timerInterval=setInterval(Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),3e3));case 1:case"end":return t.stop()}}),t)}))),e.componentDidMount=function(){e.startInterval()},e.withdrawVotes=function(){var t=Object(o.a)(r.a.mark((function t(a){var n,s,o,l,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=g.b.oldVoteLastId,s=a<=n?g.b.contract.oldWJSTAddress:g.b.contract.WJSTAddress,l={title:"toast.ex",title2:"deposit.transactionsent",title3:"toast.ex_failed",title4:"deposit.confirm_transaction",obj:{value:(o={proposalId:a,contractAddr:s}).votes,token:o.proposalId||""}},t.next=6,e.props.system.withdrawVotes(o,l);case 6:(c=t.sent)&&(console.log("withdrawVotes complete:",c),e.props.lend.setData({redeemFromVotePop:!1}));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.renderVoting=function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.props.lend.voteSourceData,s=e.state.lang;if((null===t||void 0===t?void 0:t.length)>0)return null===t||void 0===t?void 0:t.map((function(t,r){var o;return u.a.createElement("div",{className:"vote-detail-item",key:r},u.a.createElement("div",{className:"point "+("en-US"===s?"":"zh")},u.a.createElement("div",{className:"title"},"#",null===t||void 0===t?void 0:t.proposalId," ",n&&(null===(o=n[null===t||void 0===t?void 0:t.proposalId])||void 0===o?void 0:o.title)?"en-US"===s?n[t.proposalId].title.split("&&")[1]:n[t.proposalId].title.split("&&")[0]:""),u.a.createElement("div",{className:"amount"},u.a.createElement("span",null,Object(v.j)(t.allVotes,0))," JST")),a&&u.a.createElement("span",{className:"link",onClick:function(){return e.withdrawVotes(t.proposalId)}},h.a.get("vote.retrieve")))}))},e.timerInterval=null,e.state={lang:window.localStorage.getItem("lang")||h.a.options.currentLocale,visible:!1},e}return Object(c.a)(a,[{key:"componentWillUnmount",value:function(){clearInterval(this.timerInterval),this.timerInterval=null}},{key:"render",value:function(){var e=this,t=this.props.lend,a=t.userCanRedeemVoteList,n=t.userVotingVote,s=t.voteDetailModalVisible;return u.a.createElement(f.a,{title:h.a.get("vote.vote_details"),maskClosable:!1,visible:s,closable:!0,onCancel:function(){return e.props.lend.setData({voteDetailModalVisible:!1})},footer:null,width:400,className:"vote-detail-modal"},n&&(null===n||void 0===n?void 0:n.length)>0||a&&(null===a||void 0===a?void 0:a.length)>0?u.a.createElement("div",{className:"vote-detail-container"},n.length>0&&u.a.createElement("div",{className:"box full"},this.renderVoting(n)),a&&(null===a||void 0===a?void 0:a.length)>0&&u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"tip"},h.a.get("vote.can_withdraw")),u.a.createElement("div",{className:"box"},this.renderVoting(a,!0)))):u.a.createElement("div",{className:"no-data"},h.a.get("vote.no_data")))}}]),a}(u.a.Component))||n)||n)||n)||n);t.a=w},1427:function(e,t,a){"use strict";var n,s=a(1),r=a.n(s),o=a(4),l=a(8),c=a(14),i=a(17),d=a(16),m=a(0),u=a.n(m),p=(a(63),a(21)),v=a(3),f=a(213),b=a(2),h=a.n(b),g=a(9),w=(a(695),Object(p.b)("network")(n=Object(p.b)("lend")(n=Object(p.b)("system")(n=Object(p.c)(n=function(e){Object(i.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).startInterval=Object(o.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.timerInterval||(e.timerInterval=setInterval(Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),3e3));case 1:case"end":return t.stop()}}),t)}))),e.componentDidMount=function(){e.startInterval()},e.closeOldAndOpenNewModal=function(){var t=e.props.lend.voteInfo;e.props.lend.setData({voteOldWithdrawModalVisible:!1}),t&&t.success&&(null===t||void 0===t?void 0:t.surplusVotes.gt(0))&&e.props.lend.setData({withdrawPop:!0})},e.toWithdraw=function(){var t=Object(o.a)(r.a.mark((function t(a){var n,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={collateralAddress:g.b.contract.JST,jtokenAddress:g.b.contract.oldWJSTAddress,amount:Object(v.a)(a).times(g.b.tokenDefaultPrecision)._toHex()},s={title:"toast.ex",title2:"deposit.transactionsent",title3:"toast.ex_failed",title4:"deposit.confirm_transaction",obj:{value:n.collateralSymbol}},e.setState({isSuccess:!1,txID:""}),t.next=5,e.props.system.voteWithdraw(n,s);case 5:t.sent&&e.props.lend.setData({voteOldWithdrawModalVisible:!1});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.timerInterval=null,e.state={lang:window.localStorage.getItem("lang")||h.a.options.currentLocale,visible:!1},e}return Object(c.a)(a,[{key:"componentWillUnmount",value:function(){clearInterval(this.timerInterval),this.timerInterval=null}},{key:"render",value:function(){var e=this,t=this.props.lend,a=t.oldVoteInfo,n=t.voteOldWithdrawModalVisible,s=this.state.lang;return u.a.createElement(f.a,{title:h.a.get("vote.invalid_vote"),maskClosable:!1,visible:n,closable:!0,onCancel:function(){return e.closeOldAndOpenNewModal()},footer:null,width:400,className:"vote-old-withdraw-modal"},u.a.createElement("div",{className:"vote-old-withdraw-content"},u.a.createElement("div",{className:"title"},h.a.get("vote.as_jst")),u.a.createElement("div",{className:"content"},u.a.createElement("div",{className:"point"},h.a.get("vote.update_description")),u.a.createElement("div",{className:"point flex-sp"},h.a.getHTML("vote.will_receive",{amount:a&&a.success&&(null===a||void 0===a?void 0:a.surplusVotes.div(g.b.tokenDefaultPrecision).toString())}),u.a.createElement("a",{target:"vote-notice",href:"en-US"===s?g.b.voteNoticeEn:g.b.voteNoticeZn,className:"link"},h.a.get("vote.details")))),u.a.createElement("div",{className:"withdraw-btn",onClick:function(){return e.toWithdraw(a&&a.success&&(null===a||void 0===a?void 0:a.surplusVotes.div(g.b.tokenDefaultPrecision)))}},h.a.get("vote.withdraw"))))}}]),a}(u.a.Component))||n)||n)||n)||n);t.a=w},1498:function(e,t,a){"use strict";a.r(t);var n,s,r=a(8),o=a(14),l=a(17),c=a(16),i=a(0),d=a.n(i),m=a(43),u=a(1),p=a.n(u),v=a(4),f=a(145),b=a(89),h=a(319),g=a(213),w=a(67),E=a(320),N=a(63),j=a(2),x=a.n(j),k=(a(1425),a(3)),V=a(9),O=a(21),_=a(1415),y=a(1426),S=a(1427),I=a(249),D=f.a.Option,F=Object(O.b)("network")(n=Object(O.b)("system")(n=Object(O.b)("lend")(n=Object(O.c)(n=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).componentDidMount=Object(v.a)(p.a.mark((function e(){var t,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.title="Vote - JustLend DAO",n.props.lend.setData({voteForPop:!1,redeemFromVotePop:!1}),e.prev=2,e.next=5,n.props.lend.getCurrentBlock();case 5:return t=e.sent,e.next=8,n.props.lend.getVoteList(t);case 8:a=e.sent,n.setState({dataList:a.arr}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.log("getVoteList: ",e.t0);case 15:case"end":return e.stop()}}),e,null,[[2,12]])}))),n.pageChange=function(e){},n.renderVoteList=function(){var e=n.state.dataList,t=n.props.network.isConnected;if(!e||!e.length)return d.a.createElement("div",{className:""},Object(k.h)());var a=e.map((function(e,a){return e&&e.state?t?d.a.createElement(w.b,{to:{pathname:"/voteDetail",search:"?proposalId=".concat(e.proposalId)},key:a},n.renderVoteInfo(e)):d.a.createElement("a",{key:a,onClick:function(){return n.props.network.connectWallet()}},n.renderVoteInfo(e)):null}));return d.a.createElement(d.a.Fragment,null,a)},n.renderVoteInfo=function(e){var t=n.state.lang;return d.a.createElement("div",{className:"card-list"},d.a.createElement("div",{className:"flex-between"},d.a.createElement("span",{className:"c-0F134F fs14 proposal-title"},e.title?"en-US"===t?e.title.split("&&")[1]:e.title.split("&&")[0]:""),d.a.createElement("span",{className:"c-84869E fs12 proposal-id"},"# ",e.proposalId)),d.a.createElement("div",{className:"flex-between mt13"},d.a.createElement("div",{className:"cl-footer-left"},d.a.createElement("span",{className:"status sta"+e.state},e&&e.intl),1===e.state?d.a.createElement(d.a.Fragment,null,d.a.createElement("span",null,x.a.get("vote.detail_subtitle_for"),"\uff1a",d.a.createElement("span",{className:"c-0F134F fs12 fw500"},Object(k.j)(Object(k.a)(e.forVotes).div(V.b.tokenDefaultPrecision)._toHex(),0))),d.a.createElement("span",null,x.a.get("vote.detail_subtitle_against"),"\uff1a",d.a.createElement("span",{className:"c-0F134F fs12 fw500"},Object(k.j)(Object(k.a)(e.againstVotes).div(V.b.tokenDefaultPrecision)._toHex(),0)))):d.a.createElement("span",{className:"ex-"+e.state},e.exIntl)),d.a.createElement("span",{className:"fs12"},x.a.get("vote.case_info_endtime")," \xa0\xa0",d.a.createElement("span",{className:"c-84869E fs12"},new Date(e.endTime).format("yyyy-MM-dd h:m:s")))))},n.renderMyVote=function(){var e=n.props.lend,t=e.voteInfo,a=e.oldVoteInfo,s=n.state.mobile;return d.a.createElement("div",{className:"vr-info"},d.a.createElement("div",{className:"vr-header flex-between block-header"},d.a.createElement("span",{className:"c-0F134F fw600"},d.a.createElement("span",null,x.a.get("vote.myvote_title")),d.a.createElement(b.a,{title:x.a.get("vote.myvote_help"),arrowPointAtCenter:!0,placement:"topLeft",trigger:["click","hover"]},d.a.createElement("span",{className:"tooltip-icon"})))),d.a.createElement("div",{className:"vr-content"},d.a.createElement("div",{className:"flex-between mb16"},d.a.createElement("span",null,x.a.get("vote.myvote_balance")),d.a.createElement("span",{className:"fs14 c-0F134F"},t&&t.success&&Object(k.j)(t.surplusVotes.div(V.b.tokenDefaultPrecision),3,{miniText:.001}))),d.a.createElement("div",{className:"vote-detail"},d.a.createElement("div",{className:"flex-between"},d.a.createElement("span",null,x.a.get("vote.myvote_total")),d.a.createElement("span",null,t&&t.success&&a&&a.success&&Object(k.j)(t.totalVote.plus(a.totalVote).div(V.b.tokenDefaultPrecision),3,{miniText:.001}))),d.a.createElement("div",{className:"flex-between"},d.a.createElement("span",null,x.a.get("vote.myvote_voted")),s?d.a.createElement("span",{className:"link",onClick:function(){n.props.lend.setData({voteDetailModalVisible:!0})}},t&&t.success&&a&&a.success&&Object(k.j)(t.castVote.plus(a.castVote).div(V.b.tokenDefaultPrecision),3,{miniText:.001})):d.a.createElement(b.a,{arrowPointAtCenter:!0,title:x.a.get("vote.view_details"),placement:"topRight",trigger:["click","hover"]},d.a.createElement("span",{className:"link",onClick:function(){n.props.lend.setData({voteDetailModalVisible:!0})}},t&&t.success&&a&&a.success&&Object(k.j)(t.castVote.plus(a.castVote).div(V.b.tokenDefaultPrecision),3,{miniText:.001})))))),d.a.createElement("div",{className:"vr-footer flex-between"},d.a.createElement("span",{className:"btn",onClick:function(){return n.openModal()}},x.a.get("vote.myvote_deposit")),d.a.createElement("span",{className:"btn",onClick:function(){return n.withdrawClick()}},x.a.get("vote.myvote_withdraw"))),a&&a.success&&(null===a||void 0===a?void 0:a.surplusVotes.gt(0))&&d.a.createElement("div",{className:"withdraw_tip",onClick:function(){return n.props.lend.setData({voteOldWithdrawModalVisible:!0})}},d.a.createElement("div",{className:"w1314"}),d.a.createElement("div",{className:"text"},x.a.get("vote.to_withdraw")),d.a.createElement("div",{className:"w48"})))},n.getFilterData=function(){var e=Object(v.a)(p.a.mark((function e(t){var a,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.lend.voteSourceList;case 2:a=e.sent,s=Object(m.a)(a),"all"!==t&&(a=s.filter((function(e){return Object(k.a)(t).gte(4)?Object(k.a)(e.state).gte(4):e.state==t}))),n.setState({dataList:a});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.withdrawClick=function(){var e=n.props.network.isConnected,t=n.props.lend.oldVoteInfo;e?(n.setState({exchangeVoteValue:"",withdrawValue:""}),t&&t.success&&(null===t||void 0===t?void 0:t.surplusVotes.gt(0))?n.props.lend.setData({voteOldWithdrawModalVisible:!0}):n.props.lend.setData({withdrawPop:!0})):n.props.network.connectWallet()},n.exchangeVoteChange=function(e){var t=Object(k.U)(e.target.value,3),a=t.valid,s=t.str;a&&n.setState({exchangeVoteValue:s})},n.withdrawChange=function(e){var t=Object(k.U)(e.target.value,3),a=t.valid,s=t.str;a&&n.setState({withdrawValue:s})},n.maxRender=function(e){return 1===e?d.a.createElement("div",{className:"c-0F134F fs12 fw500",onClick:n.chooseMax},x.a.get("vote.voteto_input_max")):2===e?d.a.createElement("div",{className:"c-0F134F fs12 fw500",onClick:n.chooseWithdrawMax},x.a.get("vote.voteto_input_max")):void 0},n.chooseMax=function(){var e=n.props.lend.voteInfo,t=Object(k.j)(e.jstBalance.div(V.b.tokenDefaultPrecision),3,{per:!0});n.setState({exchangeVoteValue:t})},n.chooseWithdrawMax=function(){var e=n.props.lend.voteInfo,t=Object(k.j)(e.surplusVotes.div(V.b.tokenDefaultPrecision),3,{per:!0});n.setState({withdrawValue:t})},n.withdrawSubmit=function(){var e=n.state.withdrawValue;n.toWithdraw(e)},n.toDeposit=Object(v.a)(p.a.mark((function e(){var t,a,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.exchangeVoteValue,a={collateralAddress:V.b.contract.JST,jtokenAddress:V.b.contract.WJSTAddress,amount:Object(k.a)(t).times(V.b.tokenDefaultPrecision)._toHex()},s={title:"toast.ex",title2:"deposit.transactionsent",title3:"toast.ex_failed",title4:"deposit.confirm_transaction",obj:{value:a.collateralSymbol}},n.setState({isSuccess:!1,txID:""}),e.next=6,n.props.system.voteDeposit(a,s);case 6:e.sent;case 7:case"end":return e.stop()}}),e)}))),n.toWithdraw=function(){var e=Object(v.a)(p.a.mark((function e(t){var a,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={collateralAddress:V.b.contract.JST,jtokenAddress:V.b.contract.WJSTAddress,amount:Object(k.a)(t).times(V.b.tokenDefaultPrecision)._toHex()},s={title:"toast.ex",title2:"deposit.transactionsent",title3:"toast.ex_failed",title4:"deposit.confirm_transaction",obj:{value:a.collateralSymbol}},n.setState({isSuccess:!1,txID:""}),e.next=5,n.props.system.voteWithdraw(a,s);case 5:e.sent;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.getApprove=Object(v.a)(p.a.mark((function e(){var t,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={collateralAddress:V.b.contract.JST,jtokenAddress:V.b.contract.WJSTAddress,precision:V.b.tokenDefaultPrecision},e.next=4,n.props.lend.getVoteBalanceOf(t);case 4:return a=e.sent,e.abrupt("return",Object(k.a)(a).gt(0));case 8:return e.prev=8,e.t0=e.catch(0),console.log("getApprove, ",e.t0),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[0,8]])}))),n.openModal=function(){var e=n.props.network.isConnected,t=n.state.approveStatus;e?t?n.authorize():n.props.lend.setData({authorizePop:!0}):n.props.network.connectWallet()},n.toApprove=Object(v.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={collateralAddress:V.b.contract.JST,jtokenAddress:V.b.contract.WJSTAddress},{title:"deposit.confirm_approve",obj:{value:t.collateralSymbol}},n.setState({isSuccess:!1,txID:""}),e.next=5,n.props.system.approveToken(t,[["lend/hideAuthorizePop"]]);case 5:e.sent&&n.setState({approveStatus:!0},(function(){n.authorize()}));case 7:case"end":return e.stop()}}),e)}))),n.authorize=function(){n.setState({exchangeVoteValue:""}),n.props.lend.setData({exchangeVotePop:!0,authorizePop:!1})},n.hideDepositPop=function(){n.props.lend.setData({authorizePop:!1,exchangeVotePop:!1,withdrawPop:!1})},n.renderApprovePop=function(){return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"vote-authorize-logo"}),d.a.createElement("div",{className:"tac margin-0-auto fs14 c-0F134F vote-text"},x.a.get("vote.approve_text")),d.a.createElement("div",{className:"modal-btn authorize-btn mt40",onClick:function(){return n.toApprove()}},x.a.get("vote.approve_btn")))},n.renderDepositPop=function(){var e,t=n.state.lang,a=n.props.lend.voteInfo;return console.log(" Vote.js --- voteInfo:",a),a&&a.success&&(e=Object(k.j)(a.jstBalance.div(V.b.tokenDefaultPrecision),3,{per:!0})),d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"flex-between mb16"},d.a.createElement("span",{className:"c-84869E fs12"},x.a.get("vote.deposit_amount"))),d.a.createElement(h.a,{className:"mb8",value:n.state.exchangeVoteValue,placeholder:x.a.get("vote.convert_input_tips"),suffix:n.maxRender(1),onChange:n.exchangeVoteChange}),d.a.createElement("div",{className:"c-0F134F fs14 flexB"},d.a.createElement("span",{className:"c-84869E fs12"},x.a.get("vote.deposit_balance")),d.a.createElement("div",null,a&&a.success&&Object(k.j)(a.jstBalance.div(V.b.tokenDefaultPrecision),3,{miniText:.001})," ","JST",d.a.createElement("a",{className:"toSwap",href:"".concat(V.b.sunSwap,"?lang=").concat(t,"?tokenAddress=").concat(V.b.contract.JST,"&type=swap"),target:"sunswap"},x.a.get("index.get")))),d.a.createElement("div",{className:"c-84869E fs12 mb16"},x.a.get("vote.deposit_tips")),n.state.exchangeVoteValue>0?d.a.createElement("button",{className:"modal-btn authorize-btn",onClick:function(){return n.toDeposit()},disabled:Object(k.a)(n.state.exchangeVoteValue).gt(e)},Object(k.a)(n.state.exchangeVoteValue).gt(e)?x.a.get("vote.voteto_insufficient_vote_balance"):x.a.get("vote.deposit_btn_deposit")):d.a.createElement("button",{className:"modal-btn no-use-btn"},x.a.get("vote.convert_input_tips")))},n.renderWithdrawPop=function(){var e,t=n.props.lend.voteInfo;return t&&t.success&&(e=Object(k.j)(t.surplusVotes.div(V.b.tokenDefaultPrecision),3,{miniText:.001})),d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"flex-between mb16"},d.a.createElement("span",{className:"c-84869E fs12"},x.a.get("vote.withdraw_amount"))),d.a.createElement(h.a,{className:"mb8",value:n.state.withdrawValue,placeholder:x.a.get("vote.withdraw_input_tip"),suffix:n.maxRender(2),onChange:n.withdrawChange}),d.a.createElement("div",{className:"c-0F134F fs14 flexB"},d.a.createElement("span",{className:"c-84869E fs12"},x.a.get("vote.voteto_subtitle_votebal")),d.a.createElement("span",null,t&&t.success&&Object(k.j)(t.surplusVotes.div(V.b.tokenDefaultPrecision),3,{miniText:.001})," ","JST")),d.a.createElement("div",{className:"c-84869E fs12 mb16"},x.a.get("vote.deposit_tips")),n.state.withdrawValue>0?d.a.createElement("button",{className:"modal-btn authorize-btn",onClick:function(){return n.withdrawSubmit()},disabled:Object(k.a)(n.state.withdrawValue).gt(e)},Object(k.a)(n.state.withdrawValue).gt(e)?x.a.get("vote.voteto_insufficient_vote_balance"):x.a.get("index.my_withdraw")):d.a.createElement("button",{className:"modal-btn no-use-btn"},x.a.get("index.my_withdraw")))},n.getMountedData=Object(v.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getApprove();case 3:t=e.sent,n.setState({approveStatus:t},(function(){n.props.lend.getBalanceForVote(),n.props.lend.getOldWjstBalanceForVote(),n.startInterval()})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("getVoteDataError: ",e.t0);case 10:return e.next=12,n.props.lend.getUserWithdrawInfo();case 12:case"end":return e.stop()}}),e,null,[[0,7]])}))),n.startInterval=Object(v.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.timerInterval||(n.timerInterval=setInterval(Object(v.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getApprove();case 2:return t=e.sent,n.setState({approveStatus:t}),e.next=6,n.props.lend.getBalanceForVote();case 6:return e.next=8,n.props.lend.getOldWjstBalanceForVote();case 8:return e.next=10,n.props.lend.getUserWithdrawInfo();case 10:case"end":return e.stop()}}),e)}))),6e4));case 1:case"end":return e.stop()}}),e)}))),n.state={mobile:Object(N.a)(window.navigator).any,lang:window.localStorage.getItem("lang")||x.a.options.currentLocale,dataList:[{}],voteSourceList:[{}],pagination:{size:"small",pageSize:1,simple:!1,showSizeChanger:!1,hideOnSinglePage:!0},selectKey:"all",selectValue:x.a.get("vote.allcase_picker_all"),exchangeVoteValue:"",withdrawValue:"",approveStatus:null},n}return Object(o.a)(a,[{key:"renderVoteHeader",value:function(){return d.a.createElement("div",{className:"vote-header"},d.a.createElement("h1",{className:"fs30 c-0F134F fw600"},x.a.get("vote.title")),d.a.createElement("h2",{className:"fs12 c-5A5E89"},x.a.get("vote.subtitle")))}},{key:"renderVoteLeft",value:function(){var e=this.state,t=(e.dataList,e.selectValue),a=this.props.lend.voteSourceList,n=Object(k.g)(a,"intl");return d.a.createElement("div",{className:"vote-left"},d.a.createElement("div",{className:"vl-header flex-between block-header"},d.a.createElement("span",{className:"c-0F134F fw600"},x.a.get("vote.allcase.title")),d.a.createElement(f.a,{className:"vote-select",defaultValue:"all",onChange:this.getFilterData},d.a.createElement(D,{value:"all"},t,"(",a.length,")"),n&&n.length>0&&n.map((function(e,t){return d.a.createElement(D,{value:e.state,key:t},e.intl,"(",e.count,")")})))),d.a.createElement("div",{className:"vl-list"},n&&n.length>0?this.renderVoteList():Object(k.h)()))}},{key:"renderVoteRight",value:function(){return d.a.createElement("div",{className:"vote-right"},this.renderMyWallet(),this.renderMyVote())}},{key:"renderMyWallet",value:function(){var e=this.props.lend.voteInfo;return d.a.createElement("div",{className:"vr-info"},d.a.createElement("div",{className:"vr-header flex-between block-header"},d.a.createElement("span",{className:"c-0F134F fw600"},d.a.createElement("span",null,x.a.get("vote.mywallet_title")),d.a.createElement(b.a,{title:x.a.get("vote.mywallet_help"),arrowPointAtCenter:!0,placement:"topLeft",trigger:["click","hover"]},d.a.createElement("span",{className:"tooltip-icon"}))),d.a.createElement("a",{className:"btn btn-small btn-getjst",target:"swap",href:"".concat(V.b.sunSwap,"?lang=").concat(this.state.lang,"?tokenAddress=").concat(V.b.contract.JST,"&type=swap")},x.a.get("vote.mywallet_btn_getjst"))),d.a.createElement("div",{className:"vr-content"},d.a.createElement("div",{className:"flex-between"},d.a.createElement("span",{className:"c-84869E fs12"},x.a.get("vote.mywallet_jstbalance")),d.a.createElement("span",{className:"c-0F134F fs14"},e&&e.success&&Object(k.j)(e.jstBalance.div(V.b.tokenDefaultPrecision),3,{miniText:.001})," ","JST"))))}},{key:"renderVoteAddressSum",value:function(){return d.a.createElement("div",{className:"vr-info flex-between"},d.a.createElement("span",{className:"fs14 c-84869E"},x.a.get("vote.myvote_address")),d.a.createElement("span",{className:"fs14 c-0F134F"},Object(k.j)(12345678.12375,0)," "))}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerInterval),this.timerInterval=null}},{key:"render",value:function(){var e=this,t=this.state.mobile,a=this.props.network.menuFlag,n=this.props.lend,s=n.exchangeVotePop,r=n.authorizePop,o=n.withdrawPop,l=r||s||o,c="";return r?c=x.a.get("vote.approve_title"):s?c=x.a.get("vote.deposit_title"):o&&(c=x.a.get("vote.withdraw_title")),d.a.createElement("div",{className:t?"":"flex-end"},d.a.createElement(E.a,{mountedActions:this.getMountedData,classNames:t?"transparant-bg":""}),d.a.createElement("div",{className:t?"vote-container right-container mobile-right-container":a?"vote-container right-container":"vote-container right-container max-width"},this.renderVoteHeader(),d.a.createElement("div",{className:"vote-content flex-between"},this.renderVoteLeft(),this.renderVoteRight()),d.a.createElement(g.a,{visible:l,title:c,width:400,footer:null,className:"vote-deposit"+(s?" border-bottom-header":""),onCancel:function(){return e.hideDepositPop()}},r?this.renderApprovePop():s?this.renderDepositPop():this.renderWithdrawPop()),d.a.createElement(_.a,null),d.a.createElement(y.a,null),d.a.createElement(S.a,null),d.a.createElement(I.a,null)))}}]),a}(d.a.Component))||n)||n)||n)||n,P=Object(O.b)("network")(s=Object(O.c)(s=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.props.network.setData({routeName:"vote"})}},{key:"render",value:function(){return d.a.createElement("div",null,d.a.createElement(F,null))}}]),a}(d.a.Component))||s)||s;t.default=P}}]);