(this["webpackJsonpjustlend-front"]=this["webpackJsonpjustlend-front"]||[]).push([[11],{1541:function(e,t,a){},1551:function(e,t,a){"use strict";var n,o=a(1),r=a.n(o),l=a(4),s=a(8),c=a(13),i=a(17),v=a(18),d=a(0),m=a.n(d),p=(a(58),a(24)),u=a(3),g=a(243),b=a(2),h=a.n(b),f=a(9),E=(a(451),a(1538),Object(p.b)("network")(n=Object(p.b)("lend")(n=Object(p.b)("system")(n=Object(p.c)(n=function(e){Object(i.a)(a,e);var t=Object(v.a)(a);function a(){var e;return Object(s.a)(this,a),(e=t.call(this)).startInterval=Object(l.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.timerInterval||(e.timerInterval=setInterval(Object(l.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),3e3));case 1:case"end":return t.stop()}}),t)}))),e.componentDidMount=function(){e.startInterval()},e.withdrawVotes=function(){var t=Object(l.a)(r.a.mark((function t(a){var n,o,l,s,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({clickProposalId:a}),e.props.system.clearRejectError(),n=f.b.oldVoteLastId,o=a<=n?f.b.contract.oldWJSTAddress:f.b.contract.WJSTAddress,s={title:"toast.ex",title2:"deposit.transactionsent",title3:"toast.ex_failed",title4:"deposit.confirm_transaction",obj:{value:(l={proposalId:a,contractAddr:o}).votes,token:l.proposalId||""},trnasType:"withdrawVotes"},t.next=8,e.props.system.withdrawVotes(l,s);case 8:(c=t.sent)?(console.log("withdrawVotes complete:",c),e.props.lend.setData({redeemFromVotePop:!1}),e.setState({clickProposalId:""})):e.setState({clickProposalId:""});case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.renderVoting=function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.props.lend.voteSourceData,o=e.state,r=o.lang,l=o.clickProposalId;if((null===t||void 0===t?void 0:t.length)>0)return null===t||void 0===t?void 0:t.map((function(t,o){var s;return m.a.createElement("div",{className:"vote-detail-item",key:o},m.a.createElement("div",{className:"proposalId"},"#",null===t||void 0===t?void 0:t.proposalId),m.a.createElement("div",{className:"title "+("en-US"===r?"":"zh")},n&&(null===(s=n[null===t||void 0===t?void 0:t.proposalId])||void 0===s?void 0:s.title)?"en-US"===r?n[t.proposalId].title.split("&&")[1]:n[t.proposalId].title.split("&&")[0]:""),m.a.createElement("div",{className:"amount ellipsis",title:Object(u.j)(t.allVotes,3)},Object(u.j)(t.allVotes,3)),a&&(l?l===t.proposalId?m.a.createElement("div",{className:"link disabled"},m.a.createElement("span",{className:"siging-icon"})):m.a.createElement("div",{className:"link disabled"},h.a.get("v2.vote.redeem_vote_btn")):m.a.createElement("div",{className:"link",onClick:function(){return e.withdrawVotes(t.proposalId)}},h.a.get("v2.vote.redeem_vote_btn"))))}))},e.timerInterval=null,e.state={lang:window.localStorage.getItem("lang")||h.a.options.currentLocale,visible:!1,clickProposalId:""},e}return Object(c.a)(a,[{key:"componentWillUnmount",value:function(){clearInterval(this.timerInterval),this.timerInterval=null}},{key:"render",value:function(){var e=this,t=this.props.lend,a=t.userCanRedeemVoteList,n=t.userVotingVote,o=t.voteDetailModalVisible,r=t.userCanRedeemVoteNum,l=t.theme,s=this.state.clickProposalId,c=this.props.system.transModalInfo,i=c.declined,v=c.trnasType,d=Object(u.a)(r).eq(0)?0:Object(u.j)(r,3,{miniText:.001});return m.a.createElement(g.a,{title:h.a.get("v2.vote.recovered_vote"),maskClosable:!1,visible:o,closable:!0,onCancel:function(){e.props.system.clearRejectError(),e.props.lend.setData({voteDetailModalVisible:!1}),gtag("event","click",{event_category:"PC_V1.5",event_label:"recycle_votes_close"})},footer:null,className:"vote-detail-modal-v2 ".concat(l),width:457,centered:!0},m.a.createElement("div",{className:"tick-vote-logo"}),m.a.createElement("p",{className:"redeemNum"},h.a.getHTML("v2.vote.recover_vote",{value:d})),n&&(null===n||void 0===n?void 0:n.length)>0||a&&(null===a||void 0===a?void 0:a.length)>0?m.a.createElement("div",{className:"vote-detail-container"},a.length>4&&m.a.createElement("div",{className:"linear"}),a&&(null===a||void 0===a?void 0:a.length)>0&&m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"box"},this.renderVoting(a,!0))),s?m.a.createElement("div",{className:"info"},m.a.createElement("div",{className:"j-sign-tip"},m.a.createElement("span",{className:"j-sign-img"}),m.a.createElement("span",null,h.a.get("v2.sign_in_wallet")))):i&&"withdrawVotes"===v&&m.a.createElement("div",{className:"info"},m.a.createElement("div",{className:"j-reject-tip"},m.a.createElement("span",{className:"j-reject-img mt-3"}),m.a.createElement("span",null,h.a.get("v2.reject_in_wallet"))))):null)}}]),a}(m.a.Component))||n)||n)||n)||n);t.a=E},1606:function(e,t,a){},1614:function(e,t,a){"use strict";a.r(t);var n,o,r,l,s=a(8),c=a(13),i=a(17),v=a(18),d=a(0),m=a.n(d),p=a(24),u=a(453),g=a(455),b=a(35),h=a(1),f=a.n(h),E=a(4),w=a(34),N=a(6),j=a(7),_=a(14),k=a.n(_),x=a(125),O=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(a[n[o]]=e[n[o]])}return a},y=function(e){return d.createElement(x.a,null,(function(t){var a,n=t.getPrefixCls,o=t.direction,r=e.prefixCls,l=e.type,s=void 0===l?"horizontal":l,c=e.orientation,i=void 0===c?"center":c,v=e.className,m=e.children,p=e.dashed,u=e.plain,g=O(e,["prefixCls","type","orientation","className","children","dashed","plain"]),b=n("divider",r),h=i.length>0?"-".concat(i):i,f=!!m,E=k()(b,"".concat(b,"-").concat(s),(a={},Object(j.a)(a,"".concat(b,"-with-text"),f),Object(j.a)(a,"".concat(b,"-with-text").concat(h),f),Object(j.a)(a,"".concat(b,"-dashed"),!!p),Object(j.a)(a,"".concat(b,"-plain"),!!u),Object(j.a)(a,"".concat(b,"-rtl"),"rtl"===o),a),v);return d.createElement("div",Object(N.a)({className:E},g,{role:"separator"}),m&&d.createElement("span",{className:"".concat(b,"-inner-text")},m))}))},V=a(366),S=a(102),P=a(243),C=a(2),I=a.n(C),D=(a(1606),a(9)),T=a(3),M=(a(58),a(451),a(1538),Object(p.b)("network")(n=Object(p.b)("lend")(n=Object(p.b)("system")(n=Object(p.c)(n=function(e){Object(i.a)(a,e);var t=Object(v.a)(a);function a(){var e;return Object(s.a)(this,a),(e=t.call(this)).startInterval=Object(E.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.timerInterval||(e.timerInterval=setInterval(Object(E.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),3e3));case 1:case"end":return t.stop()}}),t)}))),e.componentDidMount=function(){e.startInterval()},e.closeOldAndOpenNewModal=function(){e.props.lend.setData({voteOldWithdrawModalVisible:!1}),gtag("event","click",{event_category:"PC_V1.5",event_label:"invalid_vote_close"})},e.toWithdraw=function(){var t=Object(E.a)(f.a.mark((function t(a){var n,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={collateralAddress:D.b.contract.JST,jtokenAddress:D.b.contract.oldWJSTAddress,amount:Object(T.a)(a).times(D.b.tokenDefaultPrecision)._toHex()},o={title:"toast.ex",title2:"deposit.transactionsent",title3:"toast.ex_failed",title4:"deposit.confirm_transaction",obj:{value:n.collateralSymbol},trnasType:"voteWithdraw"},e.setState({isSuccess:!1,txID:"",approving:!0}),t.next=5,e.props.system.voteWithdraw(n,o);case 5:t.sent&&e.props.lend.setData({voteOldWithdrawModalVisible:!1}),e.setState({approving:!1});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.timerInterval=null,e.state={lang:window.localStorage.getItem("lang")||I.a.options.currentLocale,visible:!1,approving:!1},e}return Object(c.a)(a,[{key:"componentWillUnmount",value:function(){clearInterval(this.timerInterval),this.timerInterval=null}},{key:"render",value:function(){var e=this,t=this.props.lend,a=t.oldVoteInfo,n=t.voteOldWithdrawModalVisible,o=t.theme,r=this.state.approving,l=this.props.system.transModalInfo,s=l.declined,c=l.trnasType;return m.a.createElement(P.a,{title:I.a.get("v2.vote.redeem_votes"),maskClosable:!1,visible:n,closable:!0,onCancel:function(){e.props.system.clearRejectError(),e.closeOldAndOpenNewModal()},footer:null,width:400,centered:!0,className:"vote-old-withdraw-modal-v2 ".concat(o)},m.a.createElement("div",{className:"vote-old-withdraw-content"},m.a.createElement("div",{className:"tick-vote-logo"}),m.a.createElement("div",{className:"title"},I.a.get("v2.vote.redeem_to_get")),m.a.createElement("div",{className:"amount"},a&&a.success&&(null===a||void 0===a?void 0:a.surplusVotes.div(D.b.tokenDefaultPrecision).toString())," ","JST"),m.a.createElement("div",{className:"desc"},I.a.get("v2.vote.redeem_invalid_vote")),r?m.a.createElement("button",{className:"j-large-btn j-supply j-signing",disabled:!0},I.a.get("v2.sign_in_wallet"),m.a.createElement("span",{className:"siging-icon"})):m.a.createElement("button",{className:"j-large-btn j-supply",onClick:function(){return e.toWithdraw(a&&a.success&&(null===a||void 0===a?void 0:a.surplusVotes.div(D.b.tokenDefaultPrecision)))}},I.a.get("v2.vote.redeem_now")),s&&"voteWithdraw"===c&&m.a.createElement("div",{className:"j-error-tip wallet-reject"},m.a.createElement("span",{className:"j-error-img"}),m.a.createElement("div",null,I.a.get("v2.reject_in_wallet")))))}}]),a}(m.a.Component))||n)||n)||n)||n),A=a(454),W=a(1551),F=function(){return m.a.createElement("div",{className:"step-container"},m.a.createElement("div",{className:"left-steps"},Object(w.a)(Array(3).keys()).map((function(e){return e++,m.a.createElement("div",{className:"step",key:e},m.a.createElement("div",{className:"step-number"},e),m.a.createElement("div",{className:"step-text-box"},m.a.createElement("div",{className:"step-title"},I.a.get("v2.vote.step".concat(e,"_title"))),m.a.createElement("div",{className:"step-desc"},I.a.get("v2.vote.step".concat(e,"_desc")))),e<=2&&m.a.createElement("div",{className:"step-arrow"}))}))),m.a.createElement("div",{className:"right-forum"},m.a.createElement("div",{className:"forum-title"},I.a.get("v2.vote.forum_title")),m.a.createElement("span",null,m.a.createElement("a",{href:"https://forum.justlend.org",target:"_blank",className:"forum-desc hover",onClick:gtag("event","click",{event_category:"PC_V1.5",event_label:"join_discussion"})},I.a.get("v2.vote.forum_desc")),m.a.createElement("div",{className:"purple-right-arrow"}))))},L=function(e){var t=e.lang,a="en-US"===t,n="zh-TC"===t;return m.a.createElement("div",{className:"faq-container"},m.a.createElement("div",{className:"faq-header"},m.a.createElement("div",{className:"faq-title"},I.a.get("v2.vote.faq")),m.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://justlendorg.zendesk.com/hc/".concat(a?"en-us":"zh-cn","/sections/360011296312"),className:"faq-more",onClick:gtag("event","click",{event_category:"PC_V1.5",event_label:"vote_faq_more"})},I.a.get("more"))),m.a.createElement(y,null),m.a.createElement("div",{className:"faq-body"},m.a.createElement("ul",null,[{url:function(e){return"https://justlendorg.zendesk.com/hc/".concat(e?"en-us":"zh-cn","/articles/360053116731")},title:function(e,t){return e?"How to get more votes?":t?"\u5982\u4f55\u514c\u63db\u9078\u7968\uff1f":"\u5982\u4f55\u5151\u6362\u9009\u7968\uff1f"}},{url:function(e){return"https://justlendorg.zendesk.com/hc/".concat(e?"en-us":"zh-cn","/articles/360053116751")},title:function(e,t){return e?"How to vote on a proposal?":t?"\u5982\u4f55\u9032\u884c\u6295\u7968\uff1f":"\u5982\u4f55\u8fdb\u884c\u6295\u7968\uff1f"}},{url:function(e){return"https://justlendorg.zendesk.com/hc/".concat(e?"en-us":"zh-cn","/articles/360052662212")},title:function(e,t){return e?"How to convert my votes back to JST?":t?"\u5982\u4f55\u8d16\u56de\u9078\u7968\uff1f":"\u5982\u4f55\u8d4e\u56de\u9009\u7968\uff1f"}}].map((function(e,t){return m.a.createElement("li",{key:t},m.a.createElement("a",{href:e.url(a),target:"_blank",rel:"noopener noreferrer",onClick:gtag("event","click",{event_category:"PC_V1.5",event_label:"vote_faq_link"})},e.title(a,n)))})))))},z=function(e){var t=(100*e).toFixed(2);return 0==t&&0!=e?"<0.01":100==t&&1!=e?"99.99":t},J=function(e){var t=e.forVotes,a=e.againstVotes,n=(t=parseInt(t))+(a=parseInt(a));return m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"p-vote-bar hide-md"},m.a.createElement("div",{className:"p-for hide-md "},0===n?"0%":z(t/n)+"%"),0!==t&&m.a.createElement("div",{className:"p-for-bar hide-md "+(t/n>=1?" per100":""),style:{width:"".concat(22+t/n*128,"px")}}),0!==a&&m.a.createElement("div",{className:"p-against-bar hide-md "+(a/n>=1?" per100":""),style:{width:"".concat(22+a/n*128,"px")}}),0===t&&0===a&&m.a.createElement("div",{className:"p-default-bar",style:{width:"150px"}}),m.a.createElement("div",{className:"p-against hide-md "},0===n?"0%":z(a/n)+"%")),m.a.createElement("div",{className:"p-vote-bar hide-lg"},m.a.createElement("div",{className:"bar-first-row hide-lg"},m.a.createElement("div",{className:"p-for"},0===n?"0%":z(t/n)+"%"),m.a.createElement("div",{className:"p-against"},0===n?"0%":z(a/n)+"%")),m.a.createElement("div",{className:"bar-second-row"},m.a.createElement("div",{className:"p-for-bar hide-lg",style:{width:"".concat(12.5+t/n*105,"px")}}),m.a.createElement("div",{className:"p-against-bar hide-lg",style:{width:"".concat(12.5+a/n*105,"px")}}))))},R=Object(p.b)("network")(o=Object(p.b)("system")(o=Object(p.b)("lend")(o=Object(p.c)(o=function(e){Object(i.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).componentDidMount=Object(E.a)(f.a.mark((function e(){var t,a,o,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.title="Vote - JustLend DAO",n.props.lend.setData({voteForPop:!1,redeemFromVotePop:!1}),e.prev=2,e.next=5,n.props.lend.getCurrentBlock();case 5:return a=e.sent,e.next=8,n.props.lend.getVoteList(a);case 8:o=e.sent,n.setState({dataList:o.arr}),r=null===(t=o.arr)||void 0===t?void 0:t[0],n.props.lend.getVoteDetail(null===r||void 0===r?void 0:r.id),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),console.log("getVoteList: ",e.t0);case 17:n.props.network.isConnected?n.getMountedData():n.props.network.initTronLinkWallet((function(){n.getMountedData()}),(function(){}),!1),n.props.network.listenTronLink(),gtag("event","Pageview",{event_category:"PC_V1.5",event_label:"vote-new"});case 20:case"end":return e.stop()}}),e,null,[[2,14]])}))),n.getMountedData=Object(E.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getApprove();case 3:t=e.sent,n.setState({approveStatus:t},(function(){n.props.lend.getBalanceForVote(),n.props.lend.getOldWjstBalanceForVote(),n.startInterval()})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("getVoteDataError: ",e.t0);case 10:return e.next=12,n.props.lend.getUserWithdrawInfo();case 12:case"end":return e.stop()}}),e,null,[[0,7]])}))),n.startInterval=Object(E.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.timerInterval||(n.timerInterval=setInterval(Object(E.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getApprove();case 2:return t=e.sent,n.setState({approveStatus:t}),e.next=6,n.props.lend.getBalanceForVote();case 6:return e.next=8,n.props.lend.getOldWjstBalanceForVote();case 8:return e.next=10,n.props.lend.getUserWithdrawInfo();case 10:case"end":return e.stop()}}),e)}))),6e4));case 1:case"end":return e.stop()}}),e)}))),n.getApprove=Object(E.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={collateralAddress:D.b.contract.JST,jtokenAddress:D.b.contract.WJSTAddress,precision:D.b.tokenDefaultPrecision},e.next=4,n.props.lend.getVoteBalanceOf(t);case 4:return a=e.sent,e.abrupt("return",Object(T.a)(a).gt(0));case 8:return e.prev=8,e.t0=e.catch(0),console.log("getApprove, ",e.t0),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[0,8]])}))),n.toggleShowProposalSectionForMobile=function(e){1===e&&n.state.showProposalSectionForMobile||(2!==e||n.state.showProposalSectionForMobile)&&n.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{showProposalSectionForMobile:!e.showProposalSectionForMobile})}))},n.openModal=function(){var e=n.props.network.isConnected,t=n.state.approveStatus;n.props.system.clearRejectError(),0!==n.props.network.isMainNetwork?(n.setState({isTxSigning:!1}),e?t?(n.authorize(),gtag("event","click",{event_category:"PC_V1.5",event_label:"get_votes"})):n.props.lend.setData({authorizePop:!0}):n.props.network.connectWallet()):n.props.network.showNetworkErrorModal()},n.withdrawClick=function(){var e=n.props.network.isConnected;n.props.lend.oldVoteInfo;n.setState({isTxSigning:!1}),e?(n.setState({exchangeVoteValue:"",withdrawValue:""}),n.props.lend.setData({withdrawPop:!0}),gtag("event","click",{event_category:"PC_V1.5",event_label:"redeem_votes"})):n.props.network.connectWalletV2()},n.authorize=function(){n.setState({exchangeVoteValue:""}),n.props.lend.setData({exchangeVotePop:!0,authorizePop:!1})},n.toApprove=Object(E.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.props.system.clearRejectError(),t={collateralAddress:D.b.contract.JST,jtokenAddress:D.b.contract.WJSTAddress,trnasType:"approve"},{title:"deposit.confirm_approve",obj:{value:t.collateralSymbol}},n.setState({isSuccess:!1,txID:"",approving:!0}),e.next=6,n.props.system.approveToken(t,[["lend/hideAuthorizePop"]]);case 6:e.sent&&n.setState({approveStatus:!0},(function(){n.authorize()})),n.setState({approving:!1});case 9:case"end":return e.stop()}}),e)}))),n.renderApprovePop=function(){var e=n.state.approving,t=n.props.system.transModalInfo,a=t.declined,o=t.trnasType;return m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"v-title"},I.a.get("deposit.confirm_approve")),m.a.createElement(y,null),m.a.createElement("div",{className:"vote-authorize-logo"}),m.a.createElement("div",{className:"v-desc"},I.a.getHTML("vote.approve_text")),e?m.a.createElement("button",{className:"modal-btn is-valid",disabled:!0},I.a.get("v2.sign_in_wallet"),m.a.createElement("span",{className:"siging-icon"})):m.a.createElement("div",{className:"modal-btn is-valid",onClick:n.toApprove},I.a.get("vote.approve_btn")),a&&"approve"===o&&m.a.createElement("div",{className:"j-error-tip wallet-reject"},m.a.createElement("span",{className:"j-error-img"}),m.a.createElement("div",null,I.a.get("v2.reject_in_wallet"))))},n.chooseMax=function(){var e=n.props.lend.voteInfo,t=Object(T.j)(e.jstBalance.div(D.b.tokenDefaultPrecision),3,{per:!0});n.setState({exchangeVoteValue:t})},n.chooseWithdrawMax=function(){var e=n.props.lend.voteInfo,t=Object(T.j)(e.surplusVotes.div(D.b.tokenDefaultPrecision),3,{per:!0});n.setState({withdrawValue:t})},n.maxRender=function(e){return 1===e?m.a.createElement("div",{className:"v-max-btn",onClick:n.chooseMax},I.a.get("vote.voteto_input_max")):2===e?m.a.createElement("div",{className:"v-max-btn",onClick:n.chooseWithdrawMax},I.a.get("vote.voteto_input_max")):void 0},n.exchangeVoteChange=function(e){var t=Object(T.V)(e.target.value,3),a=t.valid,o=t.str;a&&n.setState({exchangeVoteValue:o})},n.toDeposit=Object(E.a)(f.a.mark((function e(){var t,a,o,r,l,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.system.clearRejectError(),t=n.props.lend.voteInfo,n.setState({isTxSigning:!0}),a=Object(T.j)(t.jstBalance.div(D.b.tokenDefaultPrecision),3,{per:!0}),o=n.state.exchangeVoteValue,!Object(T.a)(a).lt(Object(T.a)(o))){e.next=7;break}return e.abrupt("return");case 7:return r={collateralAddress:D.b.contract.JST,jtokenAddress:D.b.contract.WJSTAddress,amount:Object(T.a)(o).times(D.b.tokenDefaultPrecision)._toHex()},l={title:"toast.ex",title2:"deposit.transactionsent",title3:"toast.ex_failed",title4:"deposit.confirm_transaction",obj:{value:r.collateralSymbol},trnasType:"depositVote"},e.prev=9,e.next=12,n.props.system.voteDeposit(r,l);case 12:(s=e.sent)?(n.setState({isSuccess:!0,txID:s,isTxSigning:!1}),n.props.lend.setData({authorizePop:!1,exchangeVotePop:!1,withdrawPop:!1})):n.setState({isSuccess:!1,txID:s,isTxSigning:!1}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(9),n.setState({isSuccess:!1,isTxSigning:!1});case 19:case"end":return e.stop()}}),e,null,[[9,16]])}))),n.renderDepositPop=function(){var e,t=n.props.lend.voteInfo,a=n.props.system.transModalInfo,o=a.declined,r=a.trnasType;t&&t.success&&(e=Object(T.j)(t.jstBalance.div(D.b.tokenDefaultPrecision),3,{per:!0}));var l=Object(T.a)(e).gte(Object(T.a)(n.state.exchangeVoteValue)),s=Object(T.a)(n.state.exchangeVoteValue).gt(0),c=!l&&s;return m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"v-title"},I.a.get("vote.myvote_deposit")),m.a.createElement(y,null),m.a.createElement("div",{className:"tick-vote-logo"}),m.a.createElement("div",{className:"v-desc"},I.a.getHTML("v2.vote.get_vote_modal_text")),m.a.createElement("div",{className:"v-desc2"},m.a.createElement("div",{className:"v-amount"},I.a.get("vote.deposit_amount")),m.a.createElement("div",{className:"v-right"},m.a.createElement("div",{className:"v-text"},I.a.get("wallet_ballance")),t&&t.success&&m.a.createElement("div",{className:"v-balance"},Object(T.j)(t.jstBalance.div(D.b.tokenDefaultPrecision),3,{miniText:.001})," JST"),m.a.createElement("a",{className:"v-get-btn hover",target:"_blank",rel:"noopener noreferrer",href:"".concat(D.b.sunSwap,"?lang=").concat(n.state.lang,"?tokenAddress=").concat(D.b.contract.JST,"&type=swap")},I.a.get("lend.get")),m.a.createElement("span",{className:"v-arrow"}))),m.a.createElement(V.a,{allowClear:!0,className:"vote-input ".concat(c?"invalid":""),value:n.state.exchangeVoteValue,placeholder:I.a.get("vote.convert_input_tips"),suffix:n.maxRender(1),onChange:n.exchangeVoteChange,disabled:!!n.state.isTxSigning}),c&&m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"exceed-remain-votes"},I.a.get("tab.not_enough"))),n.state.isTxSigning?m.a.createElement("div",{className:"modal-btn"},I.a.get("v2.sign_in_wallet"),m.a.createElement("span",{className:"siging-icon"})):m.a.createElement("div",{onClick:!c&&s&&n.toDeposit||void 0,className:"modal-btn ".concat(!c&&s?"is-valid":"")},I.a.get("v2.vote.deposit_now")),o&&"depositVote"===r&&m.a.createElement("div",{className:"tx-failed"},m.a.createElement("span",{className:"error-img"}),I.a.get("v2.reject_in_wallet")))},n.withdrawChange=function(e){var t=Object(T.V)(e.target.value,3),a=t.valid,o=t.str;a&&n.setState({withdrawValue:o})},n.toWithdraw=function(){var e=Object(E.a)(f.a.mark((function e(t){var a,o,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={collateralAddress:D.b.contract.JST,jtokenAddress:D.b.contract.WJSTAddress,amount:Object(T.a)(t).times(D.b.tokenDefaultPrecision)._toHex()},o={title:"toast.ex",title2:"deposit.transactionsent",title3:"toast.ex_failed",title4:"deposit.confirm_transaction",obj:{value:a.collateralSymbol},trnasType:"withdrawVote"},e.prev=2,e.next=5,n.props.system.voteWithdraw(a,o);case 5:(r=e.sent)?(n.setState({isSuccess:!0,txID:r,isTxSigning:!1}),n.props.lend.setData({authorizePop:!1,exchangeVotePop:!1,withdrawPop:!1})):n.setState({isSuccess:!1,txID:r,isTxSigning:!1}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),n.setState({isSuccess:!1,isTxSigning:!1});case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),n.withdrawSubmit=function(){n.props.system.clearRejectError();var e=n.state.withdrawValue;n.setState({isTxSigning:!0}),n.toWithdraw(e)},n.renderWithdrawPop=function(){var e,t=n.props.lend.voteInfo,a=n.props.system.transModalInfo,o=a.declined,r=a.trnasType;t&&t.success&&(e=Object(T.j)(t.surplusVotes.div(D.b.tokenDefaultPrecision),3,{miniText:.001,per:!0}));var l=Object(T.a)(e).gte(Object(T.a)(n.state.withdrawValue)),s=Object(T.a)(n.state.withdrawValue).gt(0),c=!l&&s;return m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"v-title"},I.a.get("v2.vote.redeem_votes")),m.a.createElement(y,null),m.a.createElement("div",{className:"tick-vote-logo"}),m.a.createElement("div",{className:"v-desc"},I.a.getHTML("v2.vote.vote_modal_convert_jst")),m.a.createElement("div",{className:"v-desc2"},m.a.createElement("div",{className:"v-amount"},I.a.getHTML("v2.vote.redeem_count")),m.a.createElement("div",{className:"v-right"},m.a.createElement("div",{className:"v-text"},I.a.get("v2.vote.surplus_votes")),m.a.createElement("div",{className:"v-balance"},e))),m.a.createElement(V.a,{allowClear:!0,className:"vote-input ".concat(c?"invalid":""),value:n.state.withdrawValue,placeholder:I.a.get("v2.vote.votes_amount"),suffix:n.maxRender(2),onChange:n.withdrawChange,disabled:!!n.state.isTxSigning}),c&&m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"exceed-remain-votes"},I.a.get("tab.not_enough"))),n.state.isTxSigning?m.a.createElement("div",{className:"modal-btn"},I.a.get("v2.sign_in_wallet"),m.a.createElement("span",{className:"siging-icon"})):m.a.createElement("div",{onClick:!c&&s&&n.withdrawSubmit||void 0,className:"modal-btn ".concat(!c&&s?"is-valid":"")},I.a.get("v2.vote.redeem_now")),o&&"withdrawVote"===r&&m.a.createElement("div",{className:"tx-failed"},m.a.createElement("span",{className:"error-img"}),I.a.get("v2.reject_in_wallet")))},n.hideDepositPop=function(){var e=n.props.lend,t=e.withdrawPop,a=e.exchangeVotePop;t?gtag("event","click",{event_category:"PC_V1.5",event_label:"redeem_votes_close"}):a&&gtag("event","click",{event_category:"PC_V1.5",event_label:"get_votes_close"}),n.props.lend.setData({authorizePop:!1,exchangeVotePop:!1,withdrawPop:!1})},n.renderMobileMenu=function(){var e=n.state,t=(e.page,e.dataList),a=e.showProposalSectionForMobile,o=(e.lang,null===t||void 0===t?void 0:t[0]);return m.a.createElement("div",{className:"mobile-menu"},m.a.createElement("span",{onClick:function(){return n.toggleShowProposalSectionForMobile(1)},className:a?"menu-item current":"menu-item"},m.a.createElement("div",{className:"p-left"},m.a.createElement("div",{className:"p-title"},I.a.get("v2.vote.proposal")),o&&m.a.createElement("div",{className:"p-count"},t.length))),m.a.createElement("span",{onClick:function(){return n.toggleShowProposalSectionForMobile(2)},className:a?"menu-item":"menu-item current"},I.a.get("v2.vote.my_vote_header")))},n.renderMyVote=function(){var e=n.props.lend,t=e.voteInfo,a=e.oldVoteInfo,o=e.userCanRedeemVoteNum,r=e.userVotingVoteNum,l=Object(T.a)(o).eq(0)?0:Object(T.j)(o,3,{miniText:.001}),s=Object(T.a)(r).eq(0)?0:Object(T.j)(r,3,{miniText:.001}),c=t&&t.success&&a&&a.success&&Object(T.j)(t.castVote.plus(a.castVote).div(D.b.tokenDefaultPrecision),3,{miniText:.001,per:!0})||0,i=t&&t.success&&a&&a.success&&Object(T.j)(t.totalVote.plus(a.totalVote).div(D.b.tokenDefaultPrecision),3,{miniText:.001,per:!0})||0,v=t&&t.success&&Object(T.j)(t.surplusVotes.div(D.b.tokenDefaultPrecision),3,{miniText:.001,per:!0})||0,d=a&&a.success&&Object(T.j)(a.surplusVotes.div(D.b.tokenDefaultPrecision),3,{miniText:.001,per:!0})||0,p=(Object(T.a)(c).gt(0)||Object(T.a)(i).gt(0)||Object(T.a)(v).gt(0))&&Object(T.a)(i).gt(Object(T.a)(d));return m.a.createElement("div",{className:"my-vote-container"},n.renderMobileMenu(),m.a.createElement("div",{className:"my-vote-header"},I.a.get("v2.vote.my_vote_header")),m.a.createElement(y,{className:"proposal-title my-vote-title"}),m.a.createElement("div",{className:"space-60"}),n.props.network.isConnected?p?m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"total-votes"},I.a.get("vote.myvote_total"),m.a.createElement(S.a,{overlayClassName:"j-tooltip-dropdown",title:I.a.get("vote.myvote_help"),arrowPointAtCenter:!0,placement:"topLeft",trigger:["click","hover"]},m.a.createElement("span",{className:"j-tooltip-icon"}))),m.a.createElement("div",{className:"total-votes-amount"},Object(T.j)(i)),m.a.createElement("div",{className:"vote-info-box"},m.a.createElement("div",{className:"vote-info-row"},m.a.createElement("div",{className:"vote-info-text"},I.a.get("v2.vote.surplus")),m.a.createElement("div",{className:"vote-info-amount"},Object(T.j)(v))),m.a.createElement("div",{className:"vote-info-row"},m.a.createElement("div",{className:"vote-info-text"},I.a.get("v2.vote.recycle_votes")),Object(T.a)(o).gt(0)?m.a.createElement("div",{className:"vote-info-amount clickable hover",onClick:function(){n.props.system.clearRejectError(),n.props.lend.setData({voteDetailModalVisible:!0}),gtag("event","click",{event_category:"PC_V1.5",event_label:"recycle_votes"})}},l):m.a.createElement("div",{className:"vote-info-amount"},l)),m.a.createElement("div",{className:"vote-info-row"},m.a.createElement("div",{className:"vote-info-text"},I.a.get("v2.vote.cast_votes")),m.a.createElement("div",{className:"vote-info-amount"},s))),m.a.createElement("div",{className:"my-vote-btn-wrapper2"},m.a.createElement("div",{className:"my-vote-btn2",onClick:function(){return n.withdrawClick()}},I.a.get("v2.vote.redeem_votes")),m.a.createElement("div",{className:"my-vote-btn",onClick:function(){return n.openModal()}},I.a.get("vote.myvote_deposit"))),a&&a.success&&(null===a||void 0===a?void 0:a.surplusVotes.gt(0))&&m.a.createElement("div",{className:"invalid-vote hover",onClick:function(){n.props.system.clearRejectError(),n.props.lend.setData({voteOldWithdrawModalVisible:!0}),gtag("event","click",{event_category:"PC_V1.5",event_label:"invalid_vote"})}},I.a.getHTML("v2.vote.invalid_vote",{value:Object(T.j)(d)}),m.a.createElement("div",{className:"purple-right-arrow2"}))):m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"tick-vote-logo"}),m.a.createElement("div",{className:"my-vote-text"},I.a.get("v2.vote.get_vote")),m.a.createElement("div",{className:"my-vote-btn-wrapper"},m.a.createElement("div",{className:"my-vote-btn",onClick:function(){return n.openModal()}},I.a.get("vote.myvote_deposit"))),a&&a.success&&(null===a||void 0===a?void 0:a.surplusVotes.gt(0))&&m.a.createElement("div",{className:"invalid-vote hover",onClick:function(){n.props.system.clearRejectError(),n.props.lend.setData({voteOldWithdrawModalVisible:!0}),gtag("event","click",{event_category:"PC_V1.5",event_label:"invalid_vote"})}},I.a.getHTML("v2.vote.invalid_vote",{value:Object(T.j)(d)}),m.a.createElement("div",{className:"purple-right-arrow2"}))):m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"unconnected-wallet-logo"}),m.a.createElement("div",{className:"my-vote-text"},I.a.get("v2.vote.unconnected_wallet")),m.a.createElement("div",{className:"my-vote-btn-wrapper"},m.a.createElement("div",{className:"my-vote-btn",onClick:function(){return n.props.network.connectWalletV2()}},I.a.get("navi.wallet_linkbtn")))))},n.state={dataList:[],page:0,showProposalSectionForMobile:!0,approveStatus:null,exchangeVoteValue:"",withdrawValue:"",isSuccess:!1,txID:"",lang:window.localStorage.getItem("lang")||I.a.options.currentLocale,isTxSigning:!1,approving:!1},n}return Object(c.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.page,n=t.dataList,o=t.showProposalSectionForMobile,r=t.lang,l=null===n||void 0===n?void 0:n[0],s=1===(null===l||void 0===l?void 0:l.state)||-1===(null===l||void 0===l?void 0:l.state),c=n.slice(s?1:0,20*(a+1)),i="en-US"===r,v=this.props.lend,d=v.exchangeVotePop,p=v.authorizePop,u=v.withdrawPop,g=v.theme,h=v.addVote,f=v.lockNum,E=v.votedList,w=p||d||u,N=Object(T.a)(f).gt(0),j="no"==h&&N||"yes"==h&&N;return m.a.createElement("div",{className:"vote-container ".concat(g)},m.a.createElement("div",{className:"common-flex"},m.a.createElement("div",{className:"common-title"},I.a.get("vote.title")),m.a.createElement("div",{className:"common-desc"},I.a.get("v2.vote.top_desc"))),m.a.createElement(F,null),m.a.createElement("div",{className:"body-container"},m.a.createElement("div",{className:"proposal-container ".concat(o?"":"hide-md")},this.renderMobileMenu(),m.a.createElement("div",{className:"proposal-header"},m.a.createElement("div",{className:"proposal-left"},m.a.createElement("div",{className:"proposal-title"},I.a.get("v2.vote.proposal")),l&&m.a.createElement("div",{className:"proposal-count"},n.length))),m.a.createElement(y,{className:"proposal-title ".concat(o?"hide-md":"")}),1===(null===l||void 0===l?void 0:l.state)||-1===(null===l||void 0===l?void 0:l.state)?m.a.createElement("div",{className:"active-proposal"},m.a.createElement("div",{className:"corner-tag"},I.a.get("v2.vote.ongoing")),m.a.createElement("div",{className:"p-body"},m.a.createElement("div",{className:"p-first-row"},m.a.createElement("div",{className:"p-title"},l.title.split("&&")[[i?1:0]]),j&&m.a.createElement(S.a,{overlayClassName:"j-tooltip-dropdown",title:I.a.get("v2.vote.voted_before"),arrowPointAtCenter:!0,placement:"top",trigger:["click","hover"],defaultVisible:!0},m.a.createElement("span",{className:"ticket-icon"})),m.a.createElement("a",{href:"?lang=".concat(r,"#/voteDetailNew?proposalId=").concat(null===l||void 0===l?void 0:l.proposalId),className:"vote-btn hide-md",onClick:gtag("event","click",{event_category:"PC_V1.5",event_label:"join_vote"})},I.a.get("v2.vote.join_vote"))),m.a.createElement("div",{className:"p-second-row"},m.a.createElement("div",{className:"p-desc"},m.a.createElement("div",{className:"p-id"},"#",l.id),m.a.createElement("div",{className:"p-countdown-text"},I.a.get("v2.vote.countdown_text")),m.a.createElement("div",{className:"p-countdown-date"},function(e){var t=(new Date).getTime();t>=e&&window.location.reload();var a=e-t,n=Math.floor(a/36e5),o=Math.floor(a%36e5/6e4)>0?Math.floor(a%36e5/6e4):"<1";return"".concat(n>0?"".concat(n).concat(I.a.get("v2.vote.hrs"),":"):"").concat(o).concat(I.a.get("v2.vote.min"))}(l.endTime))),m.a.createElement("div",{className:"p-right-mobile"},m.a.createElement(J,{forVotes:l.forVotes,againstVotes:l.againstVotes}),m.a.createElement("a",{href:"?lang=".concat(r,"##/voteDetailNew?proposalId=").concat(null===l||void 0===l?void 0:l.proposalId),className:"vote-btn hide-lg"},I.a.get("v2.vote.join_vote")))))):m.a.createElement("div",{className:"no-new-proposal"},m.a.createElement("div",{className:"proposal-title"},I.a.get("v2.vote.no_new_proposal_title")),m.a.createElement("span",null,m.a.createElement("a",{href:"https://forum.justlend.org",className:"proposal-desc hover",onClick:gtag("event","click",{event_category:"PC_V1.5",event_label:"no_new_proposal_join_discussion"})},I.a.get("v2.vote.no_new_proposal_desc")),m.a.createElement("span",{className:"purple-right-arrow"}))),m.a.createElement(y,{style:{padding:"0 30px"}},I.a.get("v2.vote.previous_voting")),m.a.createElement("div",{className:"past-proposal-list"},l&&c.length>0?c.map((function(e){return m.a.createElement("a",{href:"?lang=".concat(r,"#/voteDetailNew?proposalId=").concat(e.proposalId),target:"_blank",rel:"noopener noreferrer",key:e.id,onClick:gtag("event","click",{event_category:"PC_V1.5",event_label:"vote_proposal_list"})},m.a.createElement("div",{className:"p-item",key:e.id},m.a.createElement("div",{className:"first-row"},m.a.createElement("span",{className:"p-title"},e.title.split("&&")[i?1:0],E&&-1!=E.indexOf(e.proposalId)&&m.a.createElement(S.a,{overlayClassName:"j-tooltip-dropdown",title:I.a.get("v2.vote.voted_before"),arrowPointAtCenter:!0,placement:"top",trigger:["click","hover"]},m.a.createElement("span",{className:"ticket-icon"})),m.a.createElement("span",{className:"arrow-right"})),m.a.createElement("div",{className:e.state>=4?"p-green-tick":"p-red-exclamation"})),m.a.createElement("div",{className:"second-row"},m.a.createElement("div",{className:"p-left"},m.a.createElement("div",{className:"p-id"},"#",e.id),m.a.createElement("div",{className:"p-date"},new Date(e.endTime).format("yyyy-MM-dd h:m:s"))),m.a.createElement("div",{className:"p-status"},e.exIntl?e.exIntl:e.intl))))})):Object(T.i)()),n.length>20&&c.length<n.length&&m.a.createElement(m.a.Fragment,null,m.a.createElement(y,{className:"proposal-title mb20"}),m.a.createElement("div",{className:"load-more mb4",onClick:function(){return e.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{page:e.page+1})}))}},I.a.get("load_more")))),m.a.createElement("div",{className:"right-panel ".concat(o?"hide-md":"")},this.renderMyVote(),m.a.createElement(L,{lang:r}))),m.a.createElement(P.a,{visible:w,width:400,footer:null,className:"vote-modal ".concat(g),onCancel:function(){e.props.system.clearRejectError(),e.hideDepositPop()}},p?this.renderApprovePop():d?this.renderDepositPop():this.renderWithdrawPop()),m.a.createElement(A.a,null),m.a.createElement(W.a,null),m.a.createElement(M,null))}}]),a}(m.a.Component))||o)||o)||o)||o,H=(a(1541),a(783),Object(p.b)("network")(r=Object(p.b)("lend")(r=Object(p.b)("system")(r=Object(p.c)(r=function(e){Object(i.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={},n}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props.lend.theme;return m.a.createElement("div",{className:"j-wrapper "+e},m.a.createElement(g.a,null),m.a.createElement("div",{className:"j-container j-home"},m.a.createElement(R,null)),m.a.createElement(u.a,null))}}]),a}(m.a.Component))||r)||r)||r)||r),q=Object(p.b)("network")(l=Object(p.c)(l=function(e){Object(i.a)(a,e);var t=Object(v.a)(a);function a(e){return Object(s.a)(this,a),t.call(this,e)}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.network.setData({routeName:"vote"})}},{key:"render",value:function(){return m.a.createElement(H,null)}}]),a}(m.a.Component))||l)||l;t.default=q}}]);