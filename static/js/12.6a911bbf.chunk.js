(this["webpackJsonpjustlend-front"]=this["webpackJsonpjustlend-front"]||[]).push([[12],{1420:function(e,t,a){},1486:function(e,t,a){},1494:function(e,t,a){"use strict";a.r(t);var n,o,r,l,c=a(8),s=a(14),i=a(17),v=a(16),m=a(0),d=a.n(m),p=a(21),u=a(396),g=a(398),b=a(37),h=a(1),f=a.n(h),E=a(4),w=a(43),N=a(6),j=a(7),_=a(12),k=a.n(_),x=a(112),y=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(a[n[o]]=e[n[o]])}return a},O=function(e){return m.createElement(x.a,null,(function(t){var a,n=t.getPrefixCls,o=t.direction,r=e.prefixCls,l=e.type,c=void 0===l?"horizontal":l,s=e.orientation,i=void 0===s?"center":s,v=e.className,d=e.children,p=e.dashed,u=e.plain,g=y(e,["prefixCls","type","orientation","className","children","dashed","plain"]),b=n("divider",r),h=i.length>0?"-".concat(i):i,f=!!d,E=k()(b,"".concat(b,"-").concat(c),(a={},Object(j.a)(a,"".concat(b,"-with-text"),f),Object(j.a)(a,"".concat(b,"-with-text").concat(h),f),Object(j.a)(a,"".concat(b,"-dashed"),!!p),Object(j.a)(a,"".concat(b,"-plain"),!!u),Object(j.a)(a,"".concat(b,"-rtl"),"rtl"===o),a),v);return m.createElement("div",Object(N.a)({className:E},g,{role:"separator"}),d&&m.createElement("span",{className:"".concat(b,"-inner-text")},d))}))},V=a(319),S=a(89),P=a(213),C=a(2),D=a.n(C),T=(a(1486),a(9)),M=a(3),I=(a(63),a(395),a(1421),Object(p.b)("network")(n=Object(p.b)("lend")(n=Object(p.b)("system")(n=Object(p.c)(n=function(e){Object(i.a)(a,e);var t=Object(v.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).startInterval=Object(E.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.timerInterval||(e.timerInterval=setInterval(Object(E.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),3e3));case 1:case"end":return t.stop()}}),t)}))),e.componentDidMount=function(){e.startInterval()},e.closeOldAndOpenNewModal=function(){e.props.lend.setData({voteOldWithdrawModalVisible:!1}),gtag("event","click",{event_category:"PC_V1.5",event_label:"invalid_vote_close"})},e.toWithdraw=function(){var t=Object(E.a)(f.a.mark((function t(a){var n,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={collateralAddress:T.b.contract.JST,jtokenAddress:T.b.contract.oldWJSTAddress,amount:Object(M.a)(a).times(T.b.tokenDefaultPrecision)._toHex()},o={title:"toast.ex",title2:"deposit.transactionsent",title3:"toast.ex_failed",title4:"deposit.confirm_transaction",obj:{value:n.collateralSymbol},trnasType:"voteWithdraw"},e.setState({isSuccess:!1,txID:"",approving:!0}),t.next=5,e.props.system.voteWithdraw(n,o);case 5:t.sent&&e.props.lend.setData({voteOldWithdrawModalVisible:!1}),e.setState({approving:!1});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.timerInterval=null,e.state={lang:window.localStorage.getItem("lang")||D.a.options.currentLocale,visible:!1,approving:!1},e}return Object(s.a)(a,[{key:"componentWillUnmount",value:function(){clearInterval(this.timerInterval),this.timerInterval=null}},{key:"render",value:function(){var e=this,t=this.props.lend,a=t.oldVoteInfo,n=t.voteOldWithdrawModalVisible,o=t.theme,r=this.state.approving,l=this.props.system.transModalInfo,c=l.declined,s=l.trnasType;return d.a.createElement(P.a,{title:D.a.get("v2.vote.redeem_votes"),maskClosable:!1,visible:n,closable:!0,onCancel:function(){e.props.system.clearRejectError(),e.closeOldAndOpenNewModal()},footer:null,width:400,centered:!0,className:"vote-old-withdraw-modal-v2 ".concat(o)},d.a.createElement("div",{className:"vote-old-withdraw-content"},d.a.createElement("div",{className:"tick-vote-logo"}),d.a.createElement("div",{className:"title"},D.a.get("v2.vote.redeem_to_get")),d.a.createElement("div",{className:"amount"},a&&a.success&&(null===a||void 0===a?void 0:a.surplusVotes.div(T.b.tokenDefaultPrecision).toString())," ","JST"),d.a.createElement("div",{className:"desc"},D.a.get("v2.vote.redeem_invalid_vote")),r?d.a.createElement("button",{className:"j-large-btn j-supply j-signing",disabled:!0},D.a.get("v2.sign_in_wallet"),d.a.createElement("span",{className:"siging-icon"})):d.a.createElement("button",{className:"j-large-btn j-supply",onClick:function(){return e.toWithdraw(a&&a.success&&(null===a||void 0===a?void 0:a.surplusVotes.div(T.b.tokenDefaultPrecision)))}},D.a.get("v2.vote.redeem_now")),c&&"voteWithdraw"===s&&d.a.createElement("div",{className:"j-error-tip wallet-reject"},d.a.createElement("span",{className:"j-error-img"}),d.a.createElement("div",null,D.a.get("v2.reject_in_wallet")))))}}]),a}(d.a.Component))||n)||n)||n)||n),A=a(397),W=a(1438),F=function(){return d.a.createElement("div",{className:"step-container"},d.a.createElement("div",{className:"left-steps"},Object(w.a)(Array(3).keys()).map((function(e){return e++,d.a.createElement("div",{className:"step",key:e},d.a.createElement("div",{className:"step-number"},e),d.a.createElement("div",{className:"step-text-box"},d.a.createElement("div",{className:"step-title"},D.a.get("v2.vote.step".concat(e,"_title"))),d.a.createElement("div",{className:"step-desc"},D.a.get("v2.vote.step".concat(e,"_desc")))),e<=2&&d.a.createElement("div",{className:"step-arrow"}))}))),d.a.createElement("div",{className:"right-forum"},d.a.createElement("div",{className:"forum-title"},D.a.get("v2.vote.forum_title")),d.a.createElement("span",null,d.a.createElement("a",{href:"https://forum.justlend.org",target:"_blank",className:"forum-desc hover",onClick:gtag("event","click",{event_category:"PC_V1.5",event_label:"join_discussion"})},D.a.get("v2.vote.forum_desc")),d.a.createElement("div",{className:"purple-right-arrow"}))))},z=function(e){var t=e.lang,a="en-US"===t,n="zh-TC"===t;return d.a.createElement("div",{className:"faq-container"},d.a.createElement("div",{className:"faq-header"},d.a.createElement("div",{className:"faq-title"},D.a.get("v2.vote.faq")),d.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://justlendorg.zendesk.com/hc/".concat(a?"en-us":"zh-cn","/sections/360011296312"),className:"faq-more",onClick:gtag("event","click",{event_category:"PC_V1.5",event_label:"vote_faq_more"})},D.a.get("more"))),d.a.createElement(O,null),d.a.createElement("div",{className:"faq-body"},d.a.createElement("ul",null,[{url:function(e){return"https://justlendorg.zendesk.com/hc/".concat(e?"en-us":"zh-cn","/articles/360053116731")},title:function(e,t){return e?"How to get more votes?":t?"\u5982\u4f55\u514c\u63db\u9078\u7968\uff1f":"\u5982\u4f55\u5151\u6362\u9009\u7968\uff1f"}},{url:function(e){return"https://justlendorg.zendesk.com/hc/".concat(e?"en-us":"zh-cn","/articles/360053116751")},title:function(e,t){return e?"How to vote on a proposal?":t?"\u5982\u4f55\u9032\u884c\u6295\u7968\uff1f":"\u5982\u4f55\u8fdb\u884c\u6295\u7968\uff1f"}},{url:function(e){return"https://justlendorg.zendesk.com/hc/".concat(e?"en-us":"zh-cn","/articles/360052662212")},title:function(e,t){return e?"How to convert my votes back to JST?":t?"\u5982\u4f55\u8d16\u56de\u9078\u7968\uff1f":"\u5982\u4f55\u8d4e\u56de\u9009\u7968\uff1f"}}].map((function(e,t){return d.a.createElement("li",{key:t},d.a.createElement("a",{href:e.url(a),target:"_blank",rel:"noopener noreferrer",onClick:gtag("event","click",{event_category:"PC_V1.5",event_label:"vote_faq_link"})},e.title(a,n)))})))))},L=function(e){var t=(100*e).toFixed(2);return 0==t&&0!=e?"<0.01":100==t&&1!=e?"99.99":t},J=function(e){var t=e.forVotes,a=e.againstVotes,n=(t=parseInt(t))+(a=parseInt(a));return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"p-vote-bar hide-md"},d.a.createElement("div",{className:"p-for hide-md "},0===n?"0%":L(t/n)+"%"),0!==t&&d.a.createElement("div",{className:"p-for-bar hide-md "+(t/n>=1?" per100":""),style:{width:"".concat(22+t/n*128,"px")}}),0!==a&&d.a.createElement("div",{className:"p-against-bar hide-md "+(a/n>=1?" per100":""),style:{width:"".concat(22+a/n*128,"px")}}),0===t&&0===a&&d.a.createElement("div",{className:"p-default-bar",style:{width:"150px"}}),d.a.createElement("div",{className:"p-against hide-md "},0===n?"0%":L(a/n)+"%")),d.a.createElement("div",{className:"p-vote-bar hide-lg"},d.a.createElement("div",{className:"bar-first-row hide-lg"},d.a.createElement("div",{className:"p-for"},0===n?"0%":L(t/n)+"%"),d.a.createElement("div",{className:"p-against"},0===n?"0%":L(a/n)+"%")),d.a.createElement("div",{className:"bar-second-row"},d.a.createElement("div",{className:"p-for-bar hide-lg",style:{width:"".concat(12.5+t/n*105,"px")}}),d.a.createElement("div",{className:"p-against-bar hide-lg",style:{width:"".concat(12.5+a/n*105,"px")}}))))},R=Object(p.b)("network")(o=Object(p.b)("system")(o=Object(p.b)("lend")(o=Object(p.c)(o=function(e){Object(i.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).componentDidMount=Object(E.a)(f.a.mark((function e(){var t,a,o,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.title="Vote - JustLend DAO",n.props.lend.setData({voteForPop:!1,redeemFromVotePop:!1}),e.prev=2,e.next=5,n.props.lend.getCurrentBlock();case 5:return a=e.sent,e.next=8,n.props.lend.getVoteList(a);case 8:o=e.sent,n.setState({dataList:o.arr}),r=null===(t=o.arr)||void 0===t?void 0:t[0],n.props.lend.getVoteDetail(null===r||void 0===r?void 0:r.id),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),console.log("getVoteList: ",e.t0);case 17:n.props.network.isConnected?n.getMountedData():n.props.network.initTronLinkWallet((function(){n.getMountedData()}),(function(){}),!1),n.props.network.listenTronLink(),gtag("event","Pageview",{event_category:"PC_V1.5",event_label:"vote-new"});case 20:case"end":return e.stop()}}),e,null,[[2,14]])}))),n.getMountedData=Object(E.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getApprove();case 3:t=e.sent,n.setState({approveStatus:t},(function(){n.props.lend.getBalanceForVote(),n.props.lend.getOldWjstBalanceForVote(),n.startInterval()})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("getVoteDataError: ",e.t0);case 10:return e.next=12,n.props.lend.getUserWithdrawInfo();case 12:case"end":return e.stop()}}),e,null,[[0,7]])}))),n.startInterval=Object(E.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.timerInterval||(n.timerInterval=setInterval(Object(E.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getApprove();case 2:return t=e.sent,n.setState({approveStatus:t}),e.next=6,n.props.lend.getBalanceForVote();case 6:return e.next=8,n.props.lend.getOldWjstBalanceForVote();case 8:return e.next=10,n.props.lend.getUserWithdrawInfo();case 10:case"end":return e.stop()}}),e)}))),6e4));case 1:case"end":return e.stop()}}),e)}))),n.getApprove=Object(E.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={collateralAddress:T.b.contract.JST,jtokenAddress:T.b.contract.WJSTAddress,precision:T.b.tokenDefaultPrecision},e.next=4,n.props.lend.getVoteBalanceOf(t);case 4:return a=e.sent,e.abrupt("return",Object(M.a)(a).gt(0));case 8:return e.prev=8,e.t0=e.catch(0),console.log("getApprove, ",e.t0),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[0,8]])}))),n.toggleShowProposalSectionForMobile=function(e){1===e&&n.state.showProposalSectionForMobile||(2!==e||n.state.showProposalSectionForMobile)&&n.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{showProposalSectionForMobile:!e.showProposalSectionForMobile})}))},n.openModal=function(){var e=n.props.network.isConnected,t=n.state.approveStatus;n.props.system.clearRejectError(),0!==n.props.network.isMainNetwork?(n.setState({isTxSigning:!1}),e?t?(n.authorize(),gtag("event","click",{event_category:"PC_V1.5",event_label:"get_votes"})):n.props.lend.setData({authorizePop:!0}):n.props.network.connectWallet()):n.props.network.showNetworkErrorModal()},n.withdrawClick=function(){var e=n.props.network.isConnected;n.props.lend.oldVoteInfo;n.setState({isTxSigning:!1}),e?(n.setState({exchangeVoteValue:"",withdrawValue:""}),n.props.lend.setData({withdrawPop:!0}),gtag("event","click",{event_category:"PC_V1.5",event_label:"redeem_votes"})):n.props.network.connectWalletV2()},n.authorize=function(){n.setState({exchangeVoteValue:""}),n.props.lend.setData({exchangeVotePop:!0,authorizePop:!1})},n.toApprove=Object(E.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.props.system.clearRejectError(),t={collateralAddress:T.b.contract.JST,jtokenAddress:T.b.contract.WJSTAddress,trnasType:"approve"},{title:"deposit.confirm_approve",obj:{value:t.collateralSymbol}},n.setState({isSuccess:!1,txID:"",approving:!0}),e.next=6,n.props.system.approveToken(t,[["lend/hideAuthorizePop"]]);case 6:e.sent&&n.setState({approveStatus:!0},(function(){n.authorize()})),n.setState({approving:!1});case 9:case"end":return e.stop()}}),e)}))),n.renderApprovePop=function(){var e=n.state.approving,t=n.props.system.transModalInfo,a=t.declined,o=t.trnasType;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"v-title"},D.a.get("deposit.confirm_approve")),d.a.createElement(O,null),d.a.createElement("div",{className:"vote-authorize-logo"}),d.a.createElement("div",{className:"v-desc"},D.a.getHTML("vote.approve_text")),e?d.a.createElement("button",{className:"modal-btn is-valid",disabled:!0},D.a.get("v2.sign_in_wallet"),d.a.createElement("span",{className:"siging-icon"})):d.a.createElement("div",{className:"modal-btn is-valid",onClick:n.toApprove},D.a.get("vote.approve_btn")),a&&"approve"===o&&d.a.createElement("div",{className:"j-error-tip wallet-reject"},d.a.createElement("span",{className:"j-error-img"}),d.a.createElement("div",null,D.a.get("v2.reject_in_wallet"))))},n.chooseMax=function(){var e=n.props.lend.voteInfo,t=Object(M.j)(e.jstBalance.div(T.b.tokenDefaultPrecision),3,{per:!0});n.setState({exchangeVoteValue:t})},n.chooseWithdrawMax=function(){var e=n.props.lend.voteInfo,t=Object(M.j)(e.surplusVotes.div(T.b.tokenDefaultPrecision),3,{per:!0});n.setState({withdrawValue:t})},n.maxRender=function(e){return 1===e?d.a.createElement("div",{className:"v-max-btn",onClick:n.chooseMax},D.a.get("vote.voteto_input_max")):2===e?d.a.createElement("div",{className:"v-max-btn",onClick:n.chooseWithdrawMax},D.a.get("vote.voteto_input_max")):void 0},n.exchangeVoteChange=function(e){var t=Object(M.U)(e.target.value,3),a=t.valid,o=t.str;a&&n.setState({exchangeVoteValue:o})},n.toDeposit=Object(E.a)(f.a.mark((function e(){var t,a,o,r,l,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.system.clearRejectError(),t=n.props.lend.voteInfo,n.setState({isTxSigning:!0}),a=Object(M.j)(t.jstBalance.div(T.b.tokenDefaultPrecision),3,{per:!0}),o=n.state.exchangeVoteValue,!Object(M.a)(a).lt(Object(M.a)(o))){e.next=7;break}return e.abrupt("return");case 7:return r={collateralAddress:T.b.contract.JST,jtokenAddress:T.b.contract.WJSTAddress,amount:Object(M.a)(o).times(T.b.tokenDefaultPrecision)._toHex()},l={title:"toast.ex",title2:"deposit.transactionsent",title3:"toast.ex_failed",title4:"deposit.confirm_transaction",obj:{value:r.collateralSymbol},trnasType:"depositVote"},e.prev=9,e.next=12,n.props.system.voteDeposit(r,l);case 12:(c=e.sent)?(n.setState({isSuccess:!0,txID:c,isTxSigning:!1}),n.props.lend.setData({authorizePop:!1,exchangeVotePop:!1,withdrawPop:!1})):n.setState({isSuccess:!1,txID:c,isTxSigning:!1}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(9),n.setState({isSuccess:!1,isTxSigning:!1});case 19:case"end":return e.stop()}}),e,null,[[9,16]])}))),n.renderDepositPop=function(){var e,t=n.props.lend.voteInfo,a=n.props.system.transModalInfo,o=a.declined,r=a.trnasType;t&&t.success&&(e=Object(M.j)(t.jstBalance.div(T.b.tokenDefaultPrecision),3,{per:!0}));var l=Object(M.a)(e).gte(Object(M.a)(n.state.exchangeVoteValue)),c=Object(M.a)(n.state.exchangeVoteValue).gt(0),s=!l&&c;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"v-title"},D.a.get("vote.myvote_deposit")),d.a.createElement(O,null),d.a.createElement("div",{className:"tick-vote-logo"}),d.a.createElement("div",{className:"v-desc"},D.a.getHTML("v2.vote.get_vote_modal_text")),d.a.createElement("div",{className:"v-desc2"},d.a.createElement("div",{className:"v-amount"},D.a.get("vote.deposit_amount")),d.a.createElement("div",{className:"v-right"},d.a.createElement("div",{className:"v-text"},D.a.get("wallet_ballance")),t&&t.success&&d.a.createElement("div",{className:"v-balance"},Object(M.j)(t.jstBalance.div(T.b.tokenDefaultPrecision),3,{miniText:.001})," JST"),d.a.createElement("a",{className:"v-get-btn hover",target:"_blank",rel:"noopener noreferrer",href:"".concat(T.b.sunSwap,"?lang=").concat(n.state.lang,"?tokenAddress=").concat(T.b.contract.JST,"&type=swap")},D.a.get("lend.get")),d.a.createElement("span",{className:"v-arrow"}))),d.a.createElement(V.a,{allowClear:!0,className:"vote-input ".concat(s?"invalid":""),value:n.state.exchangeVoteValue,placeholder:D.a.get("vote.convert_input_tips"),suffix:n.maxRender(1),onChange:n.exchangeVoteChange,disabled:!!n.state.isTxSigning}),s&&d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"exceed-remain-votes"},D.a.get("tab.not_enough"))),n.state.isTxSigning?d.a.createElement("div",{className:"modal-btn"},D.a.get("v2.sign_in_wallet"),d.a.createElement("span",{className:"siging-icon"})):d.a.createElement("div",{onClick:!s&&c&&n.toDeposit||void 0,className:"modal-btn ".concat(!s&&c?"is-valid":"")},D.a.get("v2.vote.deposit_now")),o&&"depositVote"===r&&d.a.createElement("div",{className:"tx-failed"},d.a.createElement("span",{className:"error-img"}),D.a.get("v2.reject_in_wallet")))},n.withdrawChange=function(e){var t=Object(M.U)(e.target.value,3),a=t.valid,o=t.str;a&&n.setState({withdrawValue:o})},n.toWithdraw=function(){var e=Object(E.a)(f.a.mark((function e(t){var a,o,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={collateralAddress:T.b.contract.JST,jtokenAddress:T.b.contract.WJSTAddress,amount:Object(M.a)(t).times(T.b.tokenDefaultPrecision)._toHex()},o={title:"toast.ex",title2:"deposit.transactionsent",title3:"toast.ex_failed",title4:"deposit.confirm_transaction",obj:{value:a.collateralSymbol},trnasType:"withdrawVote"},e.prev=2,e.next=5,n.props.system.voteWithdraw(a,o);case 5:(r=e.sent)?(n.setState({isSuccess:!0,txID:r,isTxSigning:!1}),n.props.lend.setData({authorizePop:!1,exchangeVotePop:!1,withdrawPop:!1})):n.setState({isSuccess:!1,txID:r,isTxSigning:!1}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),n.setState({isSuccess:!1,isTxSigning:!1});case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),n.withdrawSubmit=function(){n.props.system.clearRejectError();var e=n.state.withdrawValue;n.setState({isTxSigning:!0}),n.toWithdraw(e)},n.renderWithdrawPop=function(){var e,t=n.props.lend.voteInfo,a=n.props.system.transModalInfo,o=a.declined,r=a.trnasType;t&&t.success&&(e=Object(M.j)(t.surplusVotes.div(T.b.tokenDefaultPrecision),3,{miniText:.001,per:!0}));var l=Object(M.a)(e).gte(Object(M.a)(n.state.withdrawValue)),c=Object(M.a)(n.state.withdrawValue).gt(0),s=!l&&c;return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"v-title"},D.a.get("v2.vote.redeem_votes")),d.a.createElement(O,null),d.a.createElement("div",{className:"tick-vote-logo"}),d.a.createElement("div",{className:"v-desc"},D.a.getHTML("v2.vote.vote_modal_convert_jst")),d.a.createElement("div",{className:"v-desc2"},d.a.createElement("div",{className:"v-amount"},D.a.getHTML("v2.vote.redeem_count")),d.a.createElement("div",{className:"v-right"},d.a.createElement("div",{className:"v-text"},D.a.get("v2.vote.surplus_votes")),d.a.createElement("div",{className:"v-balance"},e))),d.a.createElement(V.a,{allowClear:!0,className:"vote-input ".concat(s?"invalid":""),value:n.state.withdrawValue,placeholder:D.a.get("v2.vote.votes_amount"),suffix:n.maxRender(2),onChange:n.withdrawChange,disabled:!!n.state.isTxSigning}),s&&d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"exceed-remain-votes"},D.a.get("tab.not_enough"))),n.state.isTxSigning?d.a.createElement("div",{className:"modal-btn"},D.a.get("v2.sign_in_wallet"),d.a.createElement("span",{className:"siging-icon"})):d.a.createElement("div",{onClick:!s&&c&&n.withdrawSubmit||void 0,className:"modal-btn ".concat(!s&&c?"is-valid":"")},D.a.get("v2.vote.redeem_now")),o&&"withdrawVote"===r&&d.a.createElement("div",{className:"tx-failed"},d.a.createElement("span",{className:"error-img"}),D.a.get("v2.reject_in_wallet")))},n.hideDepositPop=function(){var e=n.props.lend,t=e.withdrawPop,a=e.exchangeVotePop;t?gtag("event","click",{event_category:"PC_V1.5",event_label:"redeem_votes_close"}):a&&gtag("event","click",{event_category:"PC_V1.5",event_label:"get_votes_close"}),n.props.lend.setData({authorizePop:!1,exchangeVotePop:!1,withdrawPop:!1})},n.renderMobileMenu=function(){var e=n.state,t=(e.page,e.dataList),a=e.showProposalSectionForMobile,o=(e.lang,null===t||void 0===t?void 0:t[0]);return d.a.createElement("div",{className:"mobile-menu"},d.a.createElement("span",{onClick:function(){return n.toggleShowProposalSectionForMobile(1)},className:a?"menu-item current":"menu-item"},d.a.createElement("div",{className:"p-left"},d.a.createElement("div",{className:"p-title"},D.a.get("v2.vote.proposal")),o&&d.a.createElement("div",{className:"p-count"},t.length))),d.a.createElement("span",{onClick:function(){return n.toggleShowProposalSectionForMobile(2)},className:a?"menu-item":"menu-item current"},D.a.get("v2.vote.my_vote_header")))},n.renderMyVote=function(){var e=n.props.lend,t=e.voteInfo,a=e.oldVoteInfo,o=e.userCanRedeemVoteNum,r=e.userVotingVoteNum,l=Object(M.a)(o).eq(0)?0:Object(M.j)(o,3,{miniText:.001}),c=Object(M.a)(r).eq(0)?0:Object(M.j)(r,3,{miniText:.001}),s=t&&t.success&&a&&a.success&&Object(M.j)(t.castVote.plus(a.castVote).div(T.b.tokenDefaultPrecision),3,{miniText:.001,per:!0})||0,i=t&&t.success&&a&&a.success&&Object(M.j)(t.totalVote.plus(a.totalVote).div(T.b.tokenDefaultPrecision),3,{miniText:.001,per:!0})||0,v=t&&t.success&&Object(M.j)(t.surplusVotes.div(T.b.tokenDefaultPrecision),3,{miniText:.001,per:!0})||0,m=a&&a.success&&Object(M.j)(a.surplusVotes.div(T.b.tokenDefaultPrecision),3,{miniText:.001,per:!0})||0,p=(Object(M.a)(s).gt(0)||Object(M.a)(i).gt(0)||Object(M.a)(v).gt(0))&&Object(M.a)(i).gt(Object(M.a)(m));return d.a.createElement("div",{className:"my-vote-container"},n.renderMobileMenu(),d.a.createElement("div",{className:"my-vote-header"},D.a.get("v2.vote.my_vote_header")),d.a.createElement(O,{className:"proposal-title my-vote-title"}),d.a.createElement("div",{className:"space-60"}),n.props.network.isConnected?p?d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"total-votes"},D.a.get("vote.myvote_total"),d.a.createElement(S.a,{overlayClassName:"j-tooltip-dropdown",title:D.a.get("vote.myvote_help"),arrowPointAtCenter:!0,placement:"topLeft",trigger:["click","hover"]},d.a.createElement("span",{className:"j-tooltip-icon"}))),d.a.createElement("div",{className:"total-votes-amount"},Object(M.j)(i)),d.a.createElement("div",{className:"vote-info-box"},d.a.createElement("div",{className:"vote-info-row"},d.a.createElement("div",{className:"vote-info-text"},D.a.get("v2.vote.surplus")),d.a.createElement("div",{className:"vote-info-amount"},Object(M.j)(v))),d.a.createElement("div",{className:"vote-info-row"},d.a.createElement("div",{className:"vote-info-text"},D.a.get("v2.vote.recycle_votes")),Object(M.a)(o).gt(0)?d.a.createElement("div",{className:"vote-info-amount clickable hover",onClick:function(){n.props.system.clearRejectError(),n.props.lend.setData({voteDetailModalVisible:!0}),gtag("event","click",{event_category:"PC_V1.5",event_label:"recycle_votes"})}},l):d.a.createElement("div",{className:"vote-info-amount"},l)),d.a.createElement("div",{className:"vote-info-row"},d.a.createElement("div",{className:"vote-info-text"},D.a.get("v2.vote.cast_votes")),d.a.createElement("div",{className:"vote-info-amount"},c))),d.a.createElement("div",{className:"my-vote-btn-wrapper2"},d.a.createElement("div",{className:"my-vote-btn2",onClick:function(){return n.withdrawClick()}},D.a.get("v2.vote.redeem_votes")),d.a.createElement("div",{className:"my-vote-btn",onClick:function(){return n.openModal()}},D.a.get("vote.myvote_deposit"))),a&&a.success&&(null===a||void 0===a?void 0:a.surplusVotes.gt(0))&&d.a.createElement("div",{className:"invalid-vote hover",onClick:function(){n.props.system.clearRejectError(),n.props.lend.setData({voteOldWithdrawModalVisible:!0}),gtag("event","click",{event_category:"PC_V1.5",event_label:"invalid_vote"})}},D.a.getHTML("v2.vote.invalid_vote",{value:Object(M.j)(m)}),d.a.createElement("div",{className:"purple-right-arrow2"}))):d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"tick-vote-logo"}),d.a.createElement("div",{className:"my-vote-text"},D.a.get("v2.vote.get_vote")),d.a.createElement("div",{className:"my-vote-btn-wrapper"},d.a.createElement("div",{className:"my-vote-btn",onClick:function(){return n.openModal()}},D.a.get("vote.myvote_deposit"))),a&&a.success&&(null===a||void 0===a?void 0:a.surplusVotes.gt(0))&&d.a.createElement("div",{className:"invalid-vote hover",onClick:function(){n.props.system.clearRejectError(),n.props.lend.setData({voteOldWithdrawModalVisible:!0}),gtag("event","click",{event_category:"PC_V1.5",event_label:"invalid_vote"})}},D.a.getHTML("v2.vote.invalid_vote",{value:Object(M.j)(m)}),d.a.createElement("div",{className:"purple-right-arrow2"}))):d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"unconnected-wallet-logo"}),d.a.createElement("div",{className:"my-vote-text"},D.a.get("v2.vote.unconnected_wallet")),d.a.createElement("div",{className:"my-vote-btn-wrapper"},d.a.createElement("div",{className:"my-vote-btn",onClick:function(){return n.props.network.connectWalletV2()}},D.a.get("navi.wallet_linkbtn")))))},n.state={dataList:[],page:0,showProposalSectionForMobile:!0,approveStatus:null,exchangeVoteValue:"",withdrawValue:"",isSuccess:!1,txID:"",lang:window.localStorage.getItem("lang")||D.a.options.currentLocale,isTxSigning:!1,approving:!1},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.page,n=t.dataList,o=t.showProposalSectionForMobile,r=t.lang,l=null===n||void 0===n?void 0:n[0],c=1===(null===l||void 0===l?void 0:l.state)||-1===(null===l||void 0===l?void 0:l.state),s=n.slice(c?1:0,20*(a+1)),i="en-US"===r,v=this.props.lend,m=v.exchangeVotePop,p=v.authorizePop,u=v.withdrawPop,g=v.theme,h=v.addVote,f=v.lockNum,E=v.votedList,w=p||m||u,N=Object(M.a)(f).gt(0),j="no"==h&&N||"yes"==h&&N;return d.a.createElement("div",{className:"vote-container ".concat(g)},d.a.createElement("div",{className:"common-flex"},d.a.createElement("div",{className:"common-title"},D.a.get("vote.title")),d.a.createElement("div",{className:"common-desc"},D.a.get("v2.vote.top_desc"))),d.a.createElement(F,null),d.a.createElement("div",{className:"body-container"},d.a.createElement("div",{className:"proposal-container ".concat(o?"":"hide-md")},this.renderMobileMenu(),d.a.createElement("div",{className:"proposal-header"},d.a.createElement("div",{className:"proposal-left"},d.a.createElement("div",{className:"proposal-title"},D.a.get("v2.vote.proposal")),l&&d.a.createElement("div",{className:"proposal-count"},n.length))),d.a.createElement(O,{className:"proposal-title ".concat(o?"hide-md":"")}),1===(null===l||void 0===l?void 0:l.state)||-1===(null===l||void 0===l?void 0:l.state)?d.a.createElement("div",{className:"active-proposal"},d.a.createElement("div",{className:"corner-tag"},D.a.get("v2.vote.ongoing")),d.a.createElement("div",{className:"p-body"},d.a.createElement("div",{className:"p-first-row"},d.a.createElement("div",{className:"p-title"},l.title.split("&&")[[i?1:0]]),j&&d.a.createElement(S.a,{overlayClassName:"j-tooltip-dropdown",title:D.a.get("v2.vote.voted_before"),arrowPointAtCenter:!0,placement:"top",trigger:["click","hover"],defaultVisible:!0},d.a.createElement("span",{className:"ticket-icon"})),d.a.createElement("a",{href:"?lang=".concat(r,"#/voteDetailNew?proposalId=").concat(null===l||void 0===l?void 0:l.proposalId),className:"vote-btn hide-md",onClick:gtag("event","click",{event_category:"PC_V1.5",event_label:"join_vote"})},D.a.get("v2.vote.join_vote"))),d.a.createElement("div",{className:"p-second-row"},d.a.createElement("div",{className:"p-desc"},d.a.createElement("div",{className:"p-id"},"#",l.id),d.a.createElement("div",{className:"p-countdown-text"},D.a.get("v2.vote.countdown_text")),d.a.createElement("div",{className:"p-countdown-date"},function(e){var t=(new Date).getTime();t>=e&&window.location.reload();var a=e-t,n=Math.floor(a/36e5),o=Math.floor(a%36e5/6e4)>0?Math.floor(a%36e5/6e4):"<1";return"".concat(n>0?"".concat(n).concat(D.a.get("v2.vote.hrs"),":"):"").concat(o).concat(D.a.get("v2.vote.min"))}(l.endTime))),d.a.createElement("div",{className:"p-right-mobile"},d.a.createElement(J,{forVotes:l.forVotes,againstVotes:l.againstVotes}),d.a.createElement("a",{href:"?lang=".concat(r,"##/voteDetailNew?proposalId=").concat(null===l||void 0===l?void 0:l.proposalId),className:"vote-btn hide-lg"},D.a.get("v2.vote.join_vote")))))):d.a.createElement("div",{className:"no-new-proposal"},d.a.createElement("div",{className:"proposal-title"},D.a.get("v2.vote.no_new_proposal_title")),d.a.createElement("span",null,d.a.createElement("a",{href:"https://forum.justlend.org",className:"proposal-desc hover",onClick:gtag("event","click",{event_category:"PC_V1.5",event_label:"no_new_proposal_join_discussion"})},D.a.get("v2.vote.no_new_proposal_desc")),d.a.createElement("span",{className:"purple-right-arrow"}))),d.a.createElement(O,{style:{padding:"0 30px"}},D.a.get("v2.vote.previous_voting")),d.a.createElement("div",{className:"past-proposal-list"},l&&s.length>0?s.map((function(e){return d.a.createElement("a",{href:"?lang=".concat(r,"#/voteDetailNew?proposalId=").concat(e.proposalId),target:"_blank",rel:"noopener noreferrer",key:e.id,onClick:gtag("event","click",{event_category:"PC_V1.5",event_label:"vote_proposal_list"})},d.a.createElement("div",{className:"p-item",key:e.id},d.a.createElement("div",{className:"first-row"},d.a.createElement("span",{className:"p-title"},e.title.split("&&")[i?1:0],E&&-1!=E.indexOf(e.proposalId)&&d.a.createElement(S.a,{overlayClassName:"j-tooltip-dropdown",title:D.a.get("v2.vote.voted_before"),arrowPointAtCenter:!0,placement:"top",trigger:["click","hover"]},d.a.createElement("span",{className:"ticket-icon"})),d.a.createElement("span",{className:"arrow-right"})),d.a.createElement("div",{className:e.state>=4?"p-green-tick":"p-red-exclamation"})),d.a.createElement("div",{className:"second-row"},d.a.createElement("div",{className:"p-left"},d.a.createElement("div",{className:"p-id"},"#",e.id),d.a.createElement("div",{className:"p-date"},new Date(e.endTime).format("yyyy-MM-dd h:m:s"))),d.a.createElement("div",{className:"p-status"},e.exIntl?e.exIntl:e.intl))))})):Object(M.i)()),n.length>20&&s.length<n.length&&d.a.createElement(d.a.Fragment,null,d.a.createElement(O,{className:"proposal-title mb20"}),d.a.createElement("div",{className:"load-more mb4",onClick:function(){return e.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{page:e.page+1})}))}},D.a.get("load_more")))),d.a.createElement("div",{className:"right-panel ".concat(o?"hide-md":"")},this.renderMyVote(),d.a.createElement(z,{lang:r}))),d.a.createElement(P.a,{visible:w,width:400,footer:null,className:"vote-modal ".concat(g),onCancel:function(){e.props.system.clearRejectError(),e.hideDepositPop()}},p?this.renderApprovePop():m?this.renderDepositPop():this.renderWithdrawPop()),d.a.createElement(A.a,null),d.a.createElement(W.a,null),d.a.createElement(I,null))}}]),a}(d.a.Component))||o)||o)||o)||o,H=(a(1420),a(705),Object(p.b)("network")(r=Object(p.b)("lend")(r=Object(p.b)("system")(r=Object(p.c)(r=function(e){Object(i.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.lend.theme;return d.a.createElement("div",{className:"j-wrapper "+e},d.a.createElement(g.a,null),d.a.createElement("div",{className:"j-container j-home"},d.a.createElement(R,null)),d.a.createElement(u.a,null))}}]),a}(d.a.Component))||r)||r)||r)||r),q=Object(p.b)("network")(l=Object(p.c)(l=function(e){Object(i.a)(a,e);var t=Object(v.a)(a);function a(e){return Object(c.a)(this,a),t.call(this,e)}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.props.network.setData({routeName:"vote"})}},{key:"render",value:function(){return d.a.createElement(H,null)}}]),a}(d.a.Component))||l)||l;t.default=q}}]);